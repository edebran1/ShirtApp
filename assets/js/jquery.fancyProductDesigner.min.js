/*
 * Fancy Product Designer v1.1.2
 *
 * Copyright 2011, Rafael Dery
 *
 */
 
(function(h){var m=function(c,m){function x(){for(var j=document.URL,$=j.indexOf("://")+3,b=j.indexOf("/",$),j=j.substring($,b),$=j.lastIndexOf(".")-1,$=j.lastIndexOf(".",$)+1,j=j.substring($,j.length),b=$=0;b<j.length;++b)var e=j.charAt(b),$=$+e.charCodeAt(0);return 2512!=$&&1109!=$&&""!=j?!0:!1}var f=h.extend({},h.fn.fancyProductDesigner.defaults,m),a=this,d,l,n,y,M,b=null,ha,e,g,G,V,q,H,Y,Q,O,S,W,D,N=0,z=-1,X=null,r=0,v=null,p=null,Z=0,I=null,aa=!1,R=!1,w=!1,s=!1,oa="Helvetica";window.localStorage.length; if(x())return!1;d=h(c).addClass("fpd-container fpd-clearfix");Y=d.children(".fpd-product").remove();Q=d.children(".fpd-design, .fpd-motive").children("img, span");q=document.createElement("canvas");if(!Boolean(q.getContext&&q.getContext("2d")))return d.append('<div class="fpd-browser-alert"><p>'+f.labels.canvasAlert+"</p></div>").children("div").append('<span><a href="http://www.mozilla.org/firefox/new/" title="Download Firefox" class="firefox"></a><a href="http://www.google.com/Chrome" title="Download Chrome" class="chrome"></a><a href="http://www.opera.com/download/" title="Download Opera" class="opera"></a></span>'), d.trigger("canvasFail"),!1;l=d.append('<div class="fpd-product-selection"><a href="#" class="fpd-scroll-up ui-state-default"><span class="ui-icon ui-icon-carat-1-n"></span></a><div><ul></ul></div><a href="#" class="fpd-scroll-down ui-state-default"><span class="ui-icon ui-icon-carat-1-s"></span></a></div>').children(".fpd-product-selection").find("ul");n=d.append('<div class="fpd-product-container"><div><div class="fpd-toolbar"></div><div class="fpd-products"></div><div class="fpd-saved-products"><ul></ul></div></div><section class="fpd-clearfix"></section></div>').children(".fpd-product-container").children("div"); if(x())return!1;ha=n.children(".fpd-toolbar").append('<div class="fpd-color-picker fpd-clearfix"><input type="text" value="" disabled="disabled" /></div><select class="fpd-fonts-dropdown"></select><input type="text" value="" class="fpd-text-input" /><div class="fpd-z-switcher ui-state-default" title="'+f.labels.zPositionSwitcher+'"><span class="ui-icon ui-icon-carat-2-n-s"></span></div><div class="fpd-reset ui-state-default" title="'+f.labels.resetButton+'"><span class="ui-icon ui-icon-refresh"></span></div><div class="fpd-deselect ui-state-default" title="'+ f.labels.deselectButton+'"><span class="ui-icon ui-icon-closethick"></span></div>');q=n.parent().children("section");M=n.children(".fpd-saved-products");e=ha.children(".fpd-color-picker");G=ha.children(".fpd-z-switcher");V=ha.children(".fpd-text-input");y=n.children(".fpd-products");this.addProduct=function(j){l.append('<li><img src="'+j[0].thumbnail+'" title="'+j[0].title+'" /></li>');l.children("li:last").click(function(){var j=h(this),b=l.find("li").index(j);if(b==z)return!1;z=b;ba(j.data("views")); return!1}).data("views",j);1<l.children("li").size()&&d.children(".fpd-product-selection").show()};this.getProduct=function(j){onlyEditableElemets="undefined"!==typeof j?j:!1;if(s)return alert(f.labels.outOfContainmentAlert),!1;ca();var $=[];y.children("div").each(function(b,e){var a=h(e),d={title:h(e).attr("title"),thumbnail:h(e).data("thumbnail"),elements:[]};a.children(j?".fpd-editable":".fpd-element").each(function(j,$){var b={},e=h($);b.title=e.attr("title");b.source=e.data("source");b.parameters= e.data("params");b.type=void 0==b.parameters.text?"image":"text";d.elements[j]=b});d.elements.sort(function(j,b){return Number(j.parameters.z)-Number(b.parameters.z)});$.push(d)});return $};this.addElement=function(j,b,e,a,c){c="undefined"!==typeof c?c:r;ca();da();if("object"!=typeof a)return alert("The element "+e+" has not a valid JSON object as parameters!"),!1;a=h.extend({},f.elementParameters,a);a.source=b;a.originX=a.x;a.originY=a.y;c=y.children("div").eq(c);var A=c.append('<div class="fpd-element"></div>').children("div:last").css({left:a.x, top:a.y,"z-index":c.children("div").size()-1}).attr("title",e).data("source",b).attr("id",c.children(".fpd-element").size()-1);a.z=c.children(".fpd-element").size()-1;E(A,a.degree);if(a.colors&&"string"==typeof a.colors)if(0==a.colors.indexOf("#"))e=a.colors.replace(/\s+/g,"").split(","),a.colors=e,a.currentColor=e[0];else{e=v[0];for(c=0;c<e.elements.length;c++)e.elements[c].title==a.colors&&(a.currentColor=e.elements[c].parameters.currentColor?e.elements[c].parameters.currentColor:e.elements[c].parameters.colors)}if("image"== j){var g=new Image;g.src=b;g.onload=function(){var j=a.width?a.width:g.width*a.scale,b=a.height?a.height:g.height*a.scale,e=1;j>b?j<f.minImageWidth?e=f.minImageWidth/j:j>f.maxImageWidth&&(e=f.maxImageWidth/j):b<f.minImageHeight?e=f.minImageHeight/b:b>f.maxImageHeight&&(e=f.maxImageHeight/b);j*=e;b*=e;if(0<a.colors.length){var e=a.currentColor,$=document.createElement("canvas"),c=$.getContext("2d");$.width=this.width;$.height=this.height;c.drawImage(this,0,0);A.append($);ja(c,e)}else A.append(g);A.children("canvas, img").width(j).height(b).parent().css({width:j, height:b});0<a.colors.length||a.removable||a.draggable||a.resizable||a.rotatable?ka(A):A.css("pointer-events","none");a.originWidth=j;a.originHeight=b;a.width=j;a.height=b;A.data("params",a);d.trigger("elementAdded",[A])}}else"text"==j?(a.text=a.text?a.text:a.source,a.font=a.font?a.font:oa,a.textSize=a.textSize?a.textSize:f.textSize*a.scale,j=h("<p>"+a.text+"</p>"),A.append(j).children("p:first").css({fontSize:a.textSize,fontFamily:a.font,paddingTop:8,paddingRight:5,paddingBottom:8,paddingLeft:5}), 0<a.colors.length&&j.css("color",a.currentColor),ka(A),A.data("params",a),d.trigger("elementAdded",[A])):alert("Sorry. This type of element is not allowed!");a.price&&(Z+=a.price,d.trigger("priceChange",[a.price,Z]))};this.addDesign=function(j,e,c){null==b&&(b=d.append('<div class="fpd-design-selection"><a href="#" class="fpd-scroll-up ui-state-default"><span class="ui-icon ui-icon-carat-1-n"></span></a><div><ul class="fpd-clearfix"></ul></div><a href="#" class="fpd-scroll-down ui-state-default"><span class="ui-icon ui-icon-carat-1-s"></span></a></div>').children(".fpd-design-selection").find("ul")); b.append("<li></li>").children("li:last").append('<img src="'+j+'" title="'+e+'" />').click(function(){var j=h(this);a.addElement("image",j.children("img").attr("src"),j.children("img").attr("title"),j.data("parameters"),r)}).data("parameters",c)};this.getPrice=function(){return Z};this.print=function(){ca();n.css("overflow","visible").parent().css("overflow","visible");y.html2canvas({onrendered:function(j){n.css("overflow","hidden").parent().css("overflow","hidden");var a=n.height()*v.length,b=window.open("", "","width="+n.width()+",height="+a+",location=no,menubar=no,scrollbars=yes,status=no,toolbar=no");b.document.title="Print Image";h(b.document.body).append('<img src="'+j.toDataURL("image/png")+'" />');setTimeout(function(){b.print()},1E3)}})};this.clear=function(){ca();n.children(".fpd-views-selection").remove();y.empty();v=p=null;r=Z=0;y.css("top",0)};this.createImage=function(j,a){"undefined"===typeof j&&(j=!0);"undefined"===typeof a&&(a=!1);ca();n.css("overflow","visible").parent().css("overflow", "visible");y.html2canvas({onrendered:function(b){n.css("overflow","hidden").parent().css("overflow","hidden");var e=b.toDataURL("image/png");if(j){var c=n.height()*v.length,c=window.open("","","width="+n.width()+",height="+c+",location=no,menubar=no,scrollbars=yes,status=no,toolbar=no");c.document.title="Product Image";h(c.document.body).append('<img src="'+e+'" />');a&&(window.location.href=c.document.getElementsByTagName("img")[0].src.replace("image/png","image/octet-stream"))}d.trigger("imageCreate", [b,e])}});return!1};var ba=function(j){da();a.clear();v=j;y.css({height:n.height()*j.length,top:0});N=Z=r=0;X=j[0].title;if(1<j.length)var b=n.append('<ul class="fpd-views-selection fpd-clearfix"></ul>').children(".fpd-views-selection");for(var e=0;e<j.length;++e){var c=j[e];y.append('<div class="fpd-single-product" style="top: '+e*n.height()+'px;" title="'+c.title+'" data-thumbnail="'+c.thumbnail+'"></div>');K(c.title,c.elements);1<j.length&&b.append('<li><img src="'+c.thumbnail+'" title="'+c.title+ '" /></li>')}1<j.length&&b.children("li").click(function(){var j=h(this),j=b.children("li").index(j);j!=r&&(ca(),r=j,y.animate({top:-(n.height()*j)},300),I=y.children("div").eq(j))});I=y.children("div:first")},K=function(j,b){for(var e=0;e<b.length;++e){var c=b[e];a.addElement(c.type,c.source,c.title,c.parameters,y.children("div").size()-1)}f.allowProductSaving&&(e=C(),e=h.map(e,function(j,a){return a}).length,0<e?H.show().children(".fpd-product-counter").text(e):H.hide())},ka=function(j){j.addClass("fpd-editable").children("img, canvas, p").css("cursor", "pointer").click(function(){ca();da();var a=j.data("params");ha.show();0<j.children("p").size()&&(g.show(),g.children('option[value="'+a.font+'"]').prop("selected","selected"),V.show().val(j.children("p").text()));p=j.addClass("selected");a.removable&&p.append('<button title="'+f.labels.removeElementButton+'" class="fpd-remove ui-state-default ui-corner-all"><span class="ui-icon ui-icon-trash"></span></button>').children(".fpd-remove ").hammer().bind("tap",function(){0!=p.data("params").price&&(Z-= p.data("params").price,d.trigger("priceChange",[p.data("params").price,Z]));h(this).parent().remove();ca();return!1});a.draggable&&(tempy=null,p.append('<button title="'+f.labels.dragElementButton+'" class="fpd-drag ui-state-default ui-corner-all"><span class="ui-icon ui-icon-arrow-4"></span></button>').hammer({drag_min_distance:1}).bind("dragstart",function(j){j.preventDefault();j.gesture.preventDefault();S=parseFloat(p.css("left"));W=parseFloat(p.css("top"));D=parseFloat(p.css("width"));aa=!0})); a.resizable&&p.append('<button title="'+f.labels.resizeElementButton+'" class="fpd-resize ui-state-default ui-corner-all"><span class="ui-icon ui-icon-arrowthick-2-se-nw"></span></button>').children(".fpd-resize").hammer({drag_min_distance:1}).bind("dragstart",function(j){j.preventDefault();j.gesture.preventDefault();R=!0});a.rotatable&&p.append('<button title="'+f.labels.rotateElementButton+'" class="fpd-rotate ui-state-default ui-corner-all"><span class="ui-icon ui-icon-arrowrefresh-1-e"></span></button>').children(".fpd-rotate").hammer({drag_min_distance:1}).bind("dragstart", function(j){j.preventDefault();j.gesture.preventDefault();w=!0});Array.isArray(a.colors)?(e.children("input").val(a.currentColor),1<a.colors.length?e.children("input").spectrum("destroy").spectrum({preferredFormat:"hex",showPaletteOnly:!0,palette:a.colors,change:function(j){fa(p,j.toHexString())}}):e.children("input").spectrum("destroy").spectrum({preferredFormat:"hex",showInput:!0,chooseText:"Change Color",change:function(j){fa(p,j.toHexString())}}),e.show()):e.hide();a.zChangeable&&G.show();if("string"== typeof a.boundingBox){var b=I.children('div[title="'+a.boundingBox+'"]');0<b.size()&&(a.boundingBox={x:b.position().left,y:b.position().top,width:b.width(),height:b.height()})}"object"==typeof a.boundingBox&&(a=a.boundingBox,I.append('<div class="containment"></div>').children(".containment").css({left:a.x,top:a.y,width:a.width,height:a.height,"z-index":I.children("div").size()-1}));f.editorMode&&P()})},fa=function(j,a){4==a.length&&(a+=a.substr(1,a.length));if(0<j.children("p").size())j.children("p").css("color", a);else{var b=j.children("canvas").get(0);ja(b.getContext("2d"),a)}j.data("params").currentColor=a;e.children("input").spectrum("set",a);var c=j.attr("title"),d=a;0==r&&y.children("div").each(function(j,a){0<j&&h(a).children("div").each(function(j,a){c==h(a).data("params").colors&&h(a).data("params").currentColor!=d&&fa(h(a),d)})})},ja=function(j,a){for(var b=j.getImageData(0,0,j.canvas.width,j.canvas.height),e=b.data,c=0;c<e.length;c+=4)e[c]=parseInt(F(a).substring(0,2),16),e[c+1]=parseInt(F(a).substring(2, 4),16),e[c+2]=parseInt(F(a).substring(4,6),16);j.putImageData(b,0,0)},ca=function(){I&&(I.children("div").removeClass("selected").children("button").remove(),I.children("div.containment").remove());e.hide();G.hide();ha.hide();g.hide();V.val("").hide();p=null;f.editorMode&&O.find("p > span:nth-child(2n)").text("")},U=function(j,a,b,e){var c=p.data("params").boundingBox,d=!1;j<c.x&&(d=!0);a<c.y&&(d=!0);j+b>c.x+c.width&&(d=!0);a+e>c.y+c.height&&(d=!0);return d},P=function(){if(p){var j=p.data("params"); O.children(".fpd-current-element").children("span:last").text(p.attr("title"));O.children(".fpd-position").children("span:last").text("x: "+j.x+", y: "+j.y);O.children(".fpd-dimensions").children("span:last").text(j.width?"Width: "+j.width+"px, Height: "+j.height+"px":"Textsize: "+j.textSize+"px")}},E=function(j,a){j.css("-moz-transform","rotate("+a+"deg)");j.css("-webkit-transform","rotate("+a+"deg)");j.css("-o-transform","rotate("+a+"deg)");j.css("-ms-transform","rotate("+a+"deg)")},C=function(){for(var j= 0,a=0,b={},e=Object.keys(window.localStorage),c;c=e[j];){var d=c.substr(0,c.indexOf("_"));X==d&&window.localStorage.getItem(c)&&(b[c]=JSON.parse(window.localStorage.getItem(c)),a++);j++}return b},T=function(j){var a=Number(H.children(".fpd-product-counter").text());j="+"==j?a+1:a-1;0>=j?(H.hide().children(".fpd-product-counter").text(""),da()):H.show().children(".fpd-product-counter").text(String(j))},da=function(){M.hasClass("fpd-showing")&&M.removeClass("fpd-showing").animate({left:-(M.outerWidth()+ 10)},300)},F=function(j){return"#"==j.charAt(0)?j.substring(1,7):j};d.children("div:last").css("marginRight",0).trigger("ready");for(var A=[],L=0;L<Y.length;++L){A=h(Y.get(L)).children(".fpd-product");A.splice(0,0,Y.get(L));var ua=[];A.each(function(j,a){var b=h(a),e={title:a.title,thumbnail:b.data("thumbnail"),elements:[]};b.children("img,span").each(function(j,a){var b=h(a),b={type:b.is("img")?"image":"text",source:b.is("img")?b.attr("src"):b.text(),title:b.attr("title"),parameters:void 0==b.data("parameters")? {}:b.data("parameters")};e.elements.push(b)});ua.push(e)});a.addProduct(ua)}if(0<Q.size()){Q.parent().remove();for(L=0;L<Q.length;++L)a.addDesign(Q[L].src,Q[L].title,h(Q[L]).data("parameters"))}g=ha.children(".fpd-fonts-dropdown").change(function(){p.data("params").font=this.value;p.children("p").css("font-family",this.value)});G.click(function(){var j=parseInt(p.css("z-index"));p.css("z-index",++j);I.children("div").size()==j&&p.css("z-index",-1);p.data("params").z=parseInt(p.css("z-index"))});f.customTexts&& q.append('<button title="'+f.labels.customTextButton+'" class="fpd-add-custom-text ui-state-default ui-corner-all"><span class="ui-icon ui-icon-pencil"></span><span>'+f.customTexts+"</span></button>").children(".fpd-add-custom-text").click(function(){a.addElement("text",f.defaultCustomText,f.defaultCustomText,f.customTextParamters,r);return!1});f.allowProductSaving&&(q.append('<button title="'+f.labels.saveProductButton+'" class="fpd-save-product fpd-clearfix ui-state-default ui-corner-all"><span class="ui-icon ui-icon-disk"></span><span>'+ f.labels.saveProductButton+'</span></button><button title="'+f.labels.savedProductsButton+'" class="fpd-saved-products ui-state-default ui-corner-all" style="display: none;"><span class="ui-icon ui-icon-note"></span><span>'+f.labels.savedProductsButton+'</span><span class="fpd-product-counter"></span></button>').children(".fpd-save-product").click(function(){ca();da();var j=prompt(f.labels.saveProductInput,""),b;if(null==j)b=-1;else if(""==j)b=0;else{b=1;var e=Object.keys(C());for(k in e)if(e[k]== X+"_"+j){b=2;break}}if(-1==b)return!1;if(0==b)return alert(f.labels.keyNotValidAlert),!1;if(2==b){var c=confirm(f.labels.keyInUseAlert);if(!c)return!1}b=a.getProduct(!1);b=JSON.stringify(b);window.localStorage.setItem(X+"_"+j,b);H.is(":hidden")?H.show().children(".fpd-product-counter").text("1"):c||T("+");return!1}),H=q.children(".fpd-saved-products").click(function(){ca();if(M.is(":animated"))return!1;if(M.hasClass("fpd-showing"))da();else{M.children("ul").empty();var j=C(),a=Object.keys(C()).sort(); for(L in a){var b=a[L],e=j[b];M.children("ul").append('<li class="fpd-clearfix"><a href="#"><span class="ui-icon ui-icon-circle-close"></span></a><span title="'+e.title+'">'+b.substr(b.indexOf("_")+1)+"</span></li>").children("li:last").children("span").click(function(){ba(h(this).data("elements"))}).data("elements",e).parent().children("a").click(function(){if(!confirm(f.labels.confirmProductDelete))return!1;window.localStorage.removeItem(h(this).data("key"));h(this).parent().remove();T("-");return!1}).data("key", b)}M.addClass("fpd-showing").animate({left:0},300)}return!1}));q.append('<div class="fpd-element-switcher fpd-clearfix"><button title="'+f.labels.previousElementButton+'" class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-1-w"></span></button><button title="'+f.labels.nextElementButton+'" class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-1-e"></span></button></div>').find(".fpd-element-switcher > button:first").click(function(){p?0==p.prevAll(".fpd-editable:first").size()? I.children(".fpd-editable:last").children("img, canvas, p").click():p.prevAll(".fpd-editable:first").children("img, canvas, p").click():I.children(".fpd-editable:first").children("img, canvas, p").click();return!1}).parent().children("button:last").click(function(){p?0==p.nextAll(".fpd-editable:first").size()?I.children(".fpd-editable:first").children("img, canvas, p").click():p.nextAll(".fpd-editable:first").children("img, canvas, p").click():I.children(".fpd-editable:first").children("img, canvas, p").click(); return!1});if(0<f.fonts.length&&f.fontDropdown){oa=f.fonts[0];f.fonts.sort();for(L=0;L<f.fonts.length;++L)g.append('<option value="'+f.fonts[L]+'" style="font-family: '+f.fonts[L]+';">'+f.fonts[L]+"</option>");g.children('option[value="'+oa+'"]').prop("selected","selected");g.show()}V.keyup(function(){p.children("p").text(this.value);p.data("params").text=this.value});d.find(".fpd-scroll-up").click(function(){var j=h(this).next("div").children("ul"),a=0<parseInt(j.css("top"))+f.scrollAmount?Math.abs(parseInt(j.css("top"))): f.scrollAmount;0>parseInt(j.css("top"))&&j.is(":not(:animated)")&&j.animate({top:"+="+a},200);return!1});d.find(".fpd-scroll-down").click(function(){var a=h(this).parent().children("div"),b=a.children("ul"),e=Math.abs(parseInt(b.css("top")))+a.height()+f.scrollAmount<b.height()?-f.scrollAmount:Math.abs(parseInt(b.css("top")))+a.height()-b.height();Math.abs(parseInt(b.css("top")))+a.height()<b.height()&&b.is(":not(:animated)")&&b.animate({top:"+="+e},200);return!1});ha.children(".fpd-reset").click(function(){if(p){var a= p.data("params");p.css({left:a.originX,top:a.originY,width:a.originWidth,height:a.originHeight});p.children("img, canvas").width(a.originWidth).height(a.originHeight);p.children("p").css({fontSize:f.textSize*a.scale,fontFamily:oa}).text(a.source);E(p,0);a.colors&&(fa(p,a.colors[0]),a.currentColor=a.colors[0]);a.x=a.originX;a.y=a.originY;a.width=a.originWidth;a.height=a.originHeight;a.degree=0;p.data("params",a);a.boundingBox&&(U(a.x,a.y,a.width,a.height)?(d.trigger("elementOut"),s=!0):(d.trigger("elementIn"), s=!1))}});ha.children(".fpd-deselect").click(function(){ca()});d.bind("elementAdded",function(){++N==h(Y.get(z)).find("img, span").size()&&d.trigger("productCreate")});d.bind("elementOut",function(){p.append('<div class="fpd-warning"></div>').children("img, canvas, p").css("opacity",0.5)});d.bind("elementIn",function(){p.children("img, canvas, p").css("opacity",1);p.children(".fpd-warning").remove()});y.hammer({drag_min_distance:1,hold_timeout:100}).bind("drag",function(a){if(null!=p){a.preventDefault(); a.gesture.preventDefault();var b=p.offset();p.position();var e=b.left+p.width()/2,c=b.top+p.height()/2,A=a.gesture,g=A.touches[0].pageX,y=A.touches[0].pageY;a=p.data("params");if(w)b=-1*Math.atan2(g-e,y-c)*(180/Math.PI)-130,p.css("-moz-transform","rotate("+b+"deg)"),p.css("-webkit-transform","rotate("+b+"deg)"),p.css("-o-transform","rotate("+b+"deg)"),p.css("-ms-transform","rotate("+b+"deg)"),a.degree=b;else if(R)if(0<p.children("img, canvas").size()){b=D+A.deltaX<f.minImageWidth?f.minImageWidth: D+A.deltaX;b>f.maxImageWidth&&(b=f.maxImageWidth);e=Math.round(a.originHeight*(b/a.originWidth));if(e>f.maxImageHeight||e<f.minImageHeight)return!1;p.width(b).height(e).children("img, canvas").css({width:b,height:e});a.width=b;a.height=e}else b=y-b.top-20<f.minTextSize?f.minTextSize:y-b.top-20,b>f.maxTestSize&&(b=f.maxTestSize),p.children("p").css({"font-size":b}).keyup(),p.data("params").textSize=b;else aa&&(p.css({left:S+A.deltaX,top:W+A.deltaY}),p.data("params").x=parseFloat(p.css("left")),p.data("params").y= parseFloat(p.css("top")));if(a.boundingBox&&(w||aa||R))a=p.get(0).getBoundingClientRect().left-I.get(0).getBoundingClientRect().left-1,c=p.get(0).getBoundingClientRect().top-I.get(0).getBoundingClientRect().top-1,b=p.get(0).getBoundingClientRect().width-3,e=p.get(0).getBoundingClientRect().height-2,0<p.children("p").size()&&(a+=5,c+=8,b-=10,e-=16),s!=U(a,c,b,e)&&(U(a,c,b,e)?(d.trigger("elementOut",[p]),s=!0):(d.trigger("elementIn",[p]),s=!1));f.editorMode&&(w||aa||R)&&P()}}).bind("release",function(){w= R=aa=!1});f.editorMode&&(O=d.append('<div class="fpd-editor-box"><h3>Editor Box</h3><p class="fpd-current-element"><span>Element: </span><span></span></p><p class="fpd-position"><span>Position: </span><span></span></p><p class="fpd-dimensions"><span>Dimensions: </span><span></span></p></div>').children(".fpd-editor-box"));l.children("li:first").click()};jQuery.fn.fancyProductDesigner=function(c){return this.each(function(){var t=h(this);if(!t.data("fancy-product-designer")){var x=new m(this,c);t.data("fancy-product-designer", x)}})};h.fn.fancyProductDesigner.defaults={minImageWidth:10,minImageHeight:10,maxImageWidth:700,maxImageHeight:700,minTextSize:10,maxTestSize:50,textSize:18,scrollAmount:100,fontDropdown:!0,fonts:["Arial","Helvetica","Times New Roman","Verdana","Geneva"],customTexts:"Add text",defaultCustomText:"Enter your text here",customTextParamters:{},editorMode:!1,elementParameters:{x:0,y:0,z:0,colors:!1,removable:!1,draggable:!1,rotatable:!1,resizable:!1,zChangeable:!1,scale:1,degree:0,price:0,boundingBox:!1}, labels:{canvasAlert:"Sorry! But your browser does not support HTML5 Canvas. Please update your browser!",outOfContainmentAlert:"An element is out of his containment. Please move it in his containment!",zPositionSwitcher:"Change Z-Position",resetButton:"Reset",deselectButton:"Deselect",removeElementButton:"Remove element",dragElementButton:"Drag element",resizeElementButton:"Resize Element",rotateElementButton:"Rotate Element",customTextButton:"Add custom text",previousElementButton:"Select previous editable element", nextElementButton:"Select next editable element",saveProductButton:"Save",savedProductsButton:"Saved products",saveProductInput:"Enter a key for your product:",keyNotValidAlert:"The key is not valid!",keyInUseAlert:"The key is already used. Would you like to use it anyway?",confirmProductDelete:"Delete saved product?"},allowProductSaving:!0}})(jQuery); (function(h,m,c){function t(a){f.logging&&(h.console&&h.console.log)&&h.console.log(a)}function x(a,c,b,d,e,g){c=f.Util.getCSS(c,a,e);var l;1===c.length&&(e=c[0],c=[],c[0]=e,c[1]=e);-1!==c[0].toString().indexOf("%")?(l=parseFloat(c[0])/100,e=b.width*l,"backgroundSize"!==a&&(e-=(g||d).width*l)):e="backgroundSize"===a?"auto"===c[0]?d.width:c[0].match(/contain|cover/)?f.Util.resizeBounds(d.width,d.height,b.width,b.height,c[0]).width:parseInt(c[0],10):parseInt(c[0],10);"auto"===c[1]?b=e/d.width*d.height: -1!==c[1].toString().indexOf("%")?(l=parseFloat(c[1])/100,b=b.height*l,"backgroundSize"!==a&&(b-=(g||d).height*l)):b=parseInt(c[1],10);return[e,b]}var f={},a;f.Util={};var d=String.prototype.trim;f.Util.trimText=function(a){return d?d.apply(a):((a||"")+"").replace(/^\s+|\s+$/g,"")};f.Util.parseBackgroundImage=function(a){var c,b,d,e,g,f=[],l,q=0,n=0,h,m,t=function(){if(c){'"'===b.substr(0,1)&&(b=b.substr(1,b.length-2));b&&m.push(b);if("-"===c.substr(0,1)&&0<(e=c.indexOf("-",1)+1))d=c.substr(0,e), c=c.substr(e);f.push({prefix:d,method:c.toLowerCase(),value:g,args:m})}m=[];c=d=b=g=""};t();for(var x=0,W=a.length;x<W;x++)if(l=a[x],!(0===q&&-1<" \r\n\t".indexOf(l))){switch(l){case '"':h?h===l&&(h=null):h=l;break;case "(":if(h)break;else if(0===q){q=1;g+=l;continue}else n++;break;case ")":if(h)break;else if(1===q)if(0===n){q=0;g+=l;t();continue}else n--;break;case ",":if(!h)if(0===q){t();continue}else if(1===q&&0===n&&!c.match(/^url$/i)){m.push(b);b="";g+=l;continue}}g+=l;0===q?c+=l:b+=l}t();return f}; f.Util.Bounds=function(a){var c={};if(a.getBoundingClientRect)return a=a.getBoundingClientRect(),c.top=a.top,c.bottom=a.bottom||a.top+a.height,c.left=a.left,c.width=a.width||a.right-a.left,c.height=a.height||a.bottom-a.top,c};f.Util.getCSS=function(d,M,b){function ha(a,b){var c=d.runtimeStyle&&d.runtimeStyle[a],e,g=d.style;!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(b)&&/^-?\d/.test(b)&&(e=g.left,c&&(d.runtimeStyle.left=d.currentStyle.left),g.left="fontSize"===a?"1em":b||0,b=g.pixelLeft+"px",g.left=e,c&& (d.runtimeStyle.left=c));return!/^(thin|medium|thick)$/i.test(b)?Math.round(parseFloat(b))+"px":b}var e,g=M.match(/^background(Size|Position)$/);void 0!==d&&(a=m.defaultView.getComputedStyle(d,null));e=a[M];if(g){if(e=(e||"").split(","),e=e[b||0]||e[0]||"auto",e=f.Util.trimText(e).split(" "),!("backgroundSize"===M&&(!e[0]||e[0].match(/cover|contain|auto/)))){e[0]=-1===e[0].indexOf("%")?ha(M+"X",e[0]):e[0];if(e[1]===c){if("backgroundSize"===M)return e[1]="auto",e;e[1]=e[0]}e[1]=-1===e[1].indexOf("%")? ha(M+"Y",e[1]):e[1]}}else/border(Top|Bottom)(Left|Right)Radius/.test(M)&&(M=e.split(" "),1>=M.length&&(M[1]=M[0]),M[0]=parseInt(M[0],10),M[1]=parseInt(M[1],10),e=M);return e};f.Util.resizeBounds=function(a,c,b,d,e){a/=c;!e||"auto"===e?(e=b,b=d):b/d<a^"contain"===e?(b=d,e=d*a):(e=b,b/=a);return{width:e,height:b}};f.Util.BackgroundPosition=function(a,c,b,d,e){a=x("backgroundPosition",a,c,b,d,e);return{left:a[0],top:a[1]}};f.Util.BackgroundSize=function(a,c,b,d){a=x("backgroundSize",a,c,b,d);return{width:a[0], height:a[1]}};f.Util.Extend=function(a,c){for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);return c};f.Util.Children=function(a){var d;try{var b;if(a.nodeName&&"IFRAME"===a.nodeName.toUpperCase())b=a.contentDocument||a.contentWindow.document;else{var f=a.childNodes;a=[];if(null!==f){var e=a.length,g=0;if("number"===typeof f.length)for(var l=f.length;g<l;g++)a[e++]=f[g];else for(;f[g]!==c;)a[e++]=f[g++];a.length=e}b=a}d=b}catch(h){t("html2canvas.Util.Children failed with exception: "+h.message),d=[]}return d}; var l={};f.Util.Font=function(a,d,b){if(l[a+"-"+d]!==c)return l[a+"-"+d];var f=b.createElement("div"),e=b.createElement("img"),g=b.createElement("span"),h;f.style.visibility="hidden";f.style.fontFamily=a;f.style.fontSize=d;f.style.margin=0;f.style.padding=0;b.body.appendChild(f);e.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=";e.width=1;e.height=1;e.style.margin=0;e.style.padding=0;e.style.verticalAlign="baseline";g.style.fontFamily=a;g.style.fontSize=d;g.style.margin= 0;g.style.padding=0;g.appendChild(b.createTextNode("Hidden Text"));f.appendChild(g);f.appendChild(e);h=e.offsetTop-g.offsetTop+1;f.removeChild(g);f.appendChild(b.createTextNode("Hidden Text"));f.style.lineHeight="normal";e.style.verticalAlign="super";e={baseline:h,lineWidth:1,middle:e.offsetTop-f.offsetTop+1};l[a+"-"+d]=e;b.body.removeChild(f);return e};f.Generate={};var n=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/, /^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];f.Generate.parseGradient=function(a,c){var b,d,e=n.length,g,f,l,q;for(d=0;d<e&&!(g=a.match(n[d]));d+=1);if(g)switch(g[1]){case "-webkit-linear-gradient":case "-o-linear-gradient":b= {type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]};if(e=g[2].match(/\w+/g)){f=e.length;for(d=0;d<f;d+=1)switch(e[d]){case "top":b.y0=0;b.y1=c.height;break;case "right":b.x0=c.width;b.x1=0;break;case "bottom":b.y0=c.height;b.y1=0;break;case "left":b.x0=0,b.x1=c.width}}null===b.x0&&null===b.x1&&(b.x0=b.x1=c.width/2);null===b.y0&&null===b.y1&&(b.y0=b.y1=c.height/2);if(e=g[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g)){f=e.length;l=1/Math.max(f- 1,1);for(d=0;d<f;d+=1)q=e[d].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),q[2]?(g=parseFloat(q[2]),g="%"===q[3]?g/100:g/c.width):g=d*l,b.colorStops.push({color:q[1],stop:g})}break;case "-webkit-gradient":b={type:"radial"===g[2]?"circle":g[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]};if(e=g[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/))b.x0=e[1]*c.width/100,b.y0=e[2]*c.height/100,b.x1=e[3]*c.width/100,b.y1=e[4]*c.height/100;if(e=g[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g)){f= e.length;for(d=0;d<f;d+=1)q=e[d].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),g=parseFloat(q[2]),"from"===q[1]&&(g=0),"to"===q[1]&&(g=1),b.colorStops.push({color:q[3],stop:g})}break;case "-moz-linear-gradient":b={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]};if(e=g[2].match(/(\d{1,3})%?\s(\d{1,3})%?/))b.x0=e[1]*c.width/100,b.y0=e[2]*c.height/100,b.x1=c.width-b.x0,b.y1=c.height-b.y0;if(e=g[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g)){f= e.length;l=1/Math.max(f-1,1);for(d=0;d<f;d+=1)q=e[d].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),q[2]?(g=parseFloat(q[2]),q[3]&&(g/=100)):g=d*l,b.colorStops.push({color:q[1],stop:g})}break;case "-webkit-radial-gradient":case "-moz-radial-gradient":case "-o-radial-gradient":b={type:"circle",x0:0,y0:0,x1:c.width,y1:c.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]};if(e=g[2].match(/(\d{1,3})%?\s(\d{1,3})%?/))b.cx=e[1]*c.width/100,b.cy=e[2]*c.height/100;e=g[3].match(/\w+/); q=g[4].match(/[a-z\-]*/);if(e&&q)switch(q[0]){case "farthest-corner":case "cover":case "":d=Math.sqrt(Math.pow(b.cx,2)+Math.pow(b.cy,2));e=Math.sqrt(Math.pow(b.cx,2)+Math.pow(b.y1-b.cy,2));f=Math.sqrt(Math.pow(b.x1-b.cx,2)+Math.pow(b.y1-b.cy,2));q=Math.sqrt(Math.pow(b.x1-b.cx,2)+Math.pow(b.cy,2));b.rx=b.ry=Math.max(d,e,f,q);break;case "closest-corner":d=Math.sqrt(Math.pow(b.cx,2)+Math.pow(b.cy,2));e=Math.sqrt(Math.pow(b.cx,2)+Math.pow(b.y1-b.cy,2));f=Math.sqrt(Math.pow(b.x1-b.cx,2)+Math.pow(b.y1- b.cy,2));q=Math.sqrt(Math.pow(b.x1-b.cx,2)+Math.pow(b.cy,2));b.rx=b.ry=Math.min(d,e,f,q);break;case "farthest-side":"circle"===e[0]?b.rx=b.ry=Math.max(b.cx,b.cy,b.x1-b.cx,b.y1-b.cy):(b.type=e[0],b.rx=Math.max(b.cx,b.x1-b.cx),b.ry=Math.max(b.cy,b.y1-b.cy));break;case "closest-side":case "contain":"circle"===e[0]?b.rx=b.ry=Math.min(b.cx,b.cy,b.x1-b.cx,b.y1-b.cy):(b.type=e[0],b.rx=Math.min(b.cx,b.x1-b.cx),b.ry=Math.min(b.cy,b.y1-b.cy))}if(e=g[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g)){f= e.length;l=1/Math.max(f-1,1);for(d=0;d<f;d+=1)q=e[d].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),q[2]?(g=parseFloat(q[2]),g="%"===q[3]?g/100:g/c.width):g=d*l,b.colorStops.push({color:q[1],stop:g})}}return b};f.Generate.Gradient=function(a,c){if(!(0===c.width||0===c.height)){var b=m.createElement("canvas"),d=b.getContext("2d"),e,g,l,h;b.width=c.width;b.height=c.height;if(e=f.Generate.parseGradient(a,c))if("linear"===e.type){g=d.createLinearGradient(e.x0, e.y0,e.x1,e.y1);l=0;for(h=e.colorStops.length;l<h;l+=1)try{g.addColorStop(e.colorStops[l].stop,e.colorStops[l].color)}catch(q){t(["failed to add color stop: ",q,"; tried to add: ",e.colorStops[l],"; stop: ",l,"; in: ",a])}d.fillStyle=g;d.fillRect(0,0,c.width,c.height)}else if("circle"===e.type){g=d.createRadialGradient(e.cx,e.cy,0,e.cx,e.cy,e.rx);l=0;for(h=e.colorStops.length;l<h;l+=1)try{g.addColorStop(e.colorStops[l].stop,e.colorStops[l].color)}catch(n){t(["failed to add color stop: ",n,"; tried to add: ", e.colorStops[l],"; stop: ",l,"; in: ",a])}d.fillStyle=g;d.fillRect(0,0,c.width,c.height)}else if("ellipse"===e.type){var Y=m.createElement("canvas"),x=Y.getContext("2d");g=Math.max(e.rx,e.ry);var O=2*g;Y.width=Y.height=O;g=x.createRadialGradient(e.rx,e.ry,0,e.rx,e.ry,g);l=0;for(h=e.colorStops.length;l<h;l+=1)try{g.addColorStop(e.colorStops[l].stop,e.colorStops[l].color)}catch(S){t(["failed to add color stop: ",S,"; tried to add: ",e.colorStops[l],"; stop: ",l,"; in: ",a])}x.fillStyle=g;x.fillRect(0, 0,O,O);d.fillStyle=e.colorStops[l-1].color;d.fillRect(0,0,b.width,b.height);d.drawImage(Y,e.cx-e.rx,e.cy-e.ry,2*e.rx,2*e.ry)}return b}};f.Generate.ListAlpha=function(a){var c="",b;do b=a%26,c=String.fromCharCode(b+64)+c,a/=26;while(26<26*a);return c};f.Generate.ListRoman=function(a){var c="M CM D CD C XC L XL X IX V IV I".split(" "),b=[1E3,900,500,400,100,90,50,40,10,9,5,4,1],d="",e,f=c.length;if(0>=a||4E3<=a)return a;for(e=0;e<f;e+=1)for(;a>=b[e];)a-=b[e],d+=c[e];return d};f.Parse=function(a,d){function b(){return Math.max(Math.max(w.body.scrollWidth, w.documentElement.scrollWidth),Math.max(w.body.offsetWidth,w.documentElement.offsetWidth),Math.max(w.body.clientWidth,w.documentElement.clientWidth))}function l(){return Math.max(Math.max(w.body.scrollHeight,w.documentElement.scrollHeight),Math.max(w.body.offsetHeight,w.documentElement.offsetHeight),Math.max(w.body.clientHeight,w.documentElement.clientHeight))}function e(a,c){var b=parseInt(K(a,c),10);return isNaN(b)?0:b}function g(a,c,b,d,e,f){"transparent"!==f&&(a.setVariable("fillStyle",f),a.fillRect(c, b,d,e))}function n(a,c){switch(c){case "lowercase":return a.toLowerCase();case "capitalize":return a.replace(/(^|\s|:|-|\(|\))([a-z])/g,function(a,c,b){if(0<a.length)return c+b.toUpperCase()});case "uppercase":return a.toUpperCase();default:return a}}function V(a,c,b,d){var e=K(c,"fontWeight"),g=K(c,"fontFamily"),s=K(c,"fontSize");switch(parseInt(e,10)){case 401:e="bold";break;case 400:e="normal"}a.setVariable("fillStyle",d);a.setVariable("font",[K(c,"fontStyle"),K(c,"fontVariant"),e,s,g].join(" ")); a.setVariable("textAlign","left");if("none"!==b)return f.Util.Font(g,s,w)}function q(a,c,b){var e=b.ctx,l=K(a,"color"),R=K(a,"textDecoration");b=K(a,"textAlign");var q,p,h=c,m=0;if(0<f.Util.trimText(c.nodeValue).length){c.nodeValue=n(c.nodeValue,K(a,"textTransform"));b=b.replace(["-webkit-auto"],["auto"]);var y;if(y=!d.letterRendering){if(b=/^(left|right|justify|auto)$/.test(b))b=K(a,"letterSpacing"),b=/^(normal|none|0px)$/.test(b);y=b}p=y?c.nodeValue.split(/(\b| )/):c.nodeValue.split("");q=V(e,a, R,l);d.chinese&&p.forEach(function(a,c){/.*[\u4E00-\u9FA5].*$/.test(a)&&(a=a.split(""),a.unshift(c,1),p.splice.apply(p,a))});p.forEach(function(a,c){var b;b=c<p.length-1;var d;if(s.rangeBounds){if("none"!==R||0!==f.Util.trimText(a).length){b=h;d=m;var A=w.createRange();A.setStart(b,d);A.setEnd(b,d+a.length);d=A.getBoundingClientRect()}m+=a.length}else if(h&&"string"===typeof h.nodeValue){b=b?h.splitText(a.length):null;var L=h;d=L.parentNode;var A=w.createElement("wrapper"),ua=L.cloneNode(!0);A.appendChild(L.cloneNode(!0)); d.replaceChild(A,L);L=f.Util.Bounds(A);d.replaceChild(ua,A);d=L;h=b}if(b=d)switch(d=b.left,A=b.bottom,null!==a&&0<f.Util.trimText(a).length&&e.fillText(a,d,A),R){case "underline":g(e,b.left,Math.round(b.top+q.baseline+q.lineWidth),b.width,1,l);break;case "overline":g(e,b.left,Math.round(b.top),b.width,1,l);break;case "line-through":g(e,b.left,Math.ceil(b.top+q.middle+q.lineWidth),b.width,1,l)}})}}function H(b){return(b=a[b])&&!0===b.succeeded?b.img:!1}function x(a,b){var c=Math.max(a.left,b.left), d=Math.max(a.top,b.top),e=Math.min(a.left+a.width,b.left+b.width),f=Math.min(a.top+a.height,b.top+b.height);return{left:c,top:d,width:e-c,height:f-d}}function Q(a,b,c,d,f){var g=e(b,"paddingLeft"),w=e(b,"paddingTop"),s=e(b,"paddingRight");b=e(b,"paddingBottom");z(a,c,0,0,c.width,c.height,d.left+g+f[3].width,d.top+w+f[0].width,d.width-(f[1].width+f[3].width+g+s),d.height-(f[0].width+f[2].width+w+b))}function O(a,b,c,d){var e=function(a,b,c){return{x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}};return{start:a, startControl:b,endControl:c,end:d,subdivide:function(f){var g=e(a,b,f),w=e(b,c,f),s=e(c,d,f),l=e(g,w,f),w=e(w,s,f);f=e(l,w,f);return[O(a,g,l,f),O(f,w,s,d)]},curveTo:function(a){a.push(["bezierCurve",b.x,b.y,c.x,c.y,d.x,d.y])},curveToReversed:function(d){d.push(["bezierCurve",c.x,c.y,b.x,b.y,a.x,a.y])}}}function S(a,b,c,d,e,f,g){0<b[0]||0<b[1]?(a.push(["line",d[0].start.x,d[0].start.y]),d[0].curveTo(a),d[1].curveTo(a)):a.push(["line",f,g]);(0<c[0]||0<c[1])&&a.push(["line",e[0].start.x,e[0].start.y])} function W(a,b,c,d,e,f,g){var w=[];0<b[0]||0<b[1]?(w.push(["line",d[1].start.x,d[1].start.y]),d[1].curveTo(w)):w.push(["line",a.c1[0],a.c1[1]]);0<c[0]||0<c[1]?(w.push(["line",f[0].start.x,f[0].start.y]),f[0].curveTo(w),w.push(["line",g[0].end.x,g[0].end.y]),g[0].curveToReversed(w)):(w.push(["line",a.c2[0],a.c2[1]]),w.push(["line",a.c3[0],a.c3[1]]));0<b[0]||0<b[1]?(w.push(["line",e[1].end.x,e[1].end.y]),e[1].curveToReversed(w)):w.push(["line",a.c4[0],a.c4[1]]);return w}function D(a,b){var c=a.drawShape(); b.forEach(function(a,b){c[0===b?"moveTo":a[0]+"To"].apply(null,a.slice(1))});return c}function N(a,b,c){var d=w.createElement("valuewrap");"lineHeight textAlign fontFamily color fontSize paddingLeft paddingTop width height border borderLeftWidth borderTopWidth".split(" ").forEach(function(b){try{d.style[b]=K(a,b)}catch(c){t("html2canvas: Parse: Exception caught in renderFormValue: "+c.message)}});d.style.borderColor="black";d.style.borderStyle="solid";d.style.display="block";d.style.position="absolute"; if(/^(submit|reset|button|text|password)$/.test(a.type)||"SELECT"===a.nodeName)d.style.lineHeight=K(a,"height");d.style.top=b.top+"px";d.style.left=b.left+"px";b="SELECT"===a.nodeName?(a.options[a.selectedIndex]||0).text:a.value;b||(b=a.placeholder);b=w.createTextNode(b);d.appendChild(b);ba.appendChild(d);q(a,b,c);ba.removeChild(d)}function z(a){a.drawImage.apply(a,Array.prototype.slice.call(arguments,1))}function X(a,b){var c=h.getComputedStyle(a,b);if(c&&c.content&&!("none"===c.content||"-moz-alt-content"=== c.content)){var d=c.content+"",e=d.substr(0,1);e===d.substr(d.length-1)&&e.match(/'|"/)&&(d=d.substr(1,d.length-2));var e="url"===d.substr(0,3),g=m.createElement(e?"img":"span");g.className=ka+"-before "+ka+"-after";Object.keys(c).filter(r).forEach(function(a){g.style[a]=c[a]});e?g.src=f.Util.parseBackgroundImage(d)[0].args[0]:g.innerHTML=d;return g}}function r(a){return isNaN(h.parseInt(a,10))}function v(a,b,c,d){var e=Math.round(d.left+c.left);c=Math.round(d.top+c.top);a.createPattern(b);a.translate(e, c);a.fill();a.translate(-e,-c)}function p(a,b,c,d,e,f,g,w){var s=[];s.push(["line",Math.round(e),Math.round(f)]);s.push(["line",Math.round(e+g),Math.round(f)]);s.push(["line",Math.round(e+g),Math.round(w+f)]);s.push(["line",Math.round(e),Math.round(w+f)]);D(a,s);a.save();a.clip();v(a,b,c,d);a.restore()}function Z(a,b,c,d,e){var g=f.Util.BackgroundSize(a,b,d,e),s=f.Util.BackgroundPosition(a,b,d,e,g);a=K(a,"backgroundRepeat").split(",").map(function(a){return a.trim()});if(!(d.width===g.width&&d.height=== g.height)){var l,R=w.createElement("canvas");R.width=g.width;R.height=g.height;l=R.getContext("2d");z(l,d,0,0,d.width,d.height,0,0,g.width,g.height);d=R}a=a[e]||a[0];switch(a){case "repeat-x":p(c,d,s,b,b.left,b.top+s.top,99999,d.height);break;case "repeat-y":p(c,d,s,b,b.left+s.left,b.top,d.width,99999);break;case "no-repeat":p(c,d,s,b,b.left+s.left,b.top+s.top,d.width,d.height);break;default:v(c,d,s,{top:b.top,left:b.left,width:d.width,height:d.height})}}function I(a,c,s){var j,R,q,p,h,n,m,y,r=f.Util.Bounds(a), C,v=oa.test(a.nodeName)?"#efefef":K(a,"backgroundColor"),T;T=!c?b():r.width;var u=!c?l():r.height,ba=[];T={storage:ba,width:T,height:u,clip:function(){ba.push({type:"function",name:"clip",arguments:arguments})},translate:function(){ba.push({type:"function",name:"translate",arguments:arguments})},fill:function(){ba.push({type:"function",name:"fill",arguments:arguments})},save:function(){ba.push({type:"function",name:"save",arguments:arguments})},restore:function(){ba.push({type:"function",name:"restore", arguments:arguments})},fillRect:function(){ba.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){ba.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var a=[];ba.push({type:"function",name:"drawShape",arguments:a});return{moveTo:function(){a.push({name:"moveTo",arguments:arguments})},lineTo:function(){a.push({name:"lineTo",arguments:arguments})},arcTo:function(){a.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){a.push({name:"bezierCurveTo", arguments:arguments})},quadraticCurveTo:function(){a.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){ba.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){ba.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(a,b){ba.push({type:"variable",name:a,arguments:b})}};j=K(a,"zIndex");(u=c?c.zIndex:null)?"auto"!==j&&(j={zindex:j,children:[]},u.children.push(j),u=j):u=j={zindex:0,children:[]};j=K(a,"opacity")*(c?c.opacity: 1);T.setVariable("globalAlpha",j);var fa=K(a,"position"),da;da=["Top","Right","Bottom","Left"].map(function(b){return{width:e(a,"border"+b+"Width"),color:K(a,"border"+b+"Color")}});c={ctx:T,zIndex:u,opacity:j,cssPosition:fa,borders:da,clip:c&&c.clip?f.Util.Extend({},c.clip):null};!0===d.useOverflow&&(!0===/(hidden|scroll|auto)/.test(K(a,"overflow"))&&!1===/(BODY)/i.test(a.nodeName))&&(c.clip=c.clip?x(c.clip,r):r);c.zIndex.children.push(c);var u=c.borders,U=c.ctx;T=c.clip;j={left:r.left+u[3].width, top:r.top+u[0].width,width:r.width-(u[1].width+u[3].width),height:r.height-(u[0].width+u[2].width)};T&&(j=x(j,T));T=j;fa=r.left;da=r.top;var O=r.width,ca=r.height,I,G,E,F,P,z,B;B=["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(b){return K(a,"border"+b+"Radius")});var ga=r.left;y=r.top;n=r.width;m=r.height;R=B[0][0];q=B[0][1];p=B[1][0];h=B[1][1];F=B[2][0];P=B[2][1];I=B[3][0];G=B[3][1];var la=n-p,ia=m-F,pa=n-P;E=m-G;j=ja(ga,y,R,q).topLeft.subdivide(0.5);R=ja(ga+u[3].width,y+u[0].width, Math.max(0,R-u[3].width),Math.max(0,q-u[0].width)).topLeft.subdivide(0.5);q=ja(ga+la,y,p,h).topRight.subdivide(0.5);p=ja(ga+Math.min(la,n+u[3].width),y+u[0].width,la>n+u[3].width?0:p-u[3].width,h-u[0].width).topRight.subdivide(0.5);h=ja(ga+pa,y+ia,P,F).bottomRight.subdivide(0.5);n=ja(ga+Math.min(pa,n+u[3].width),y+Math.min(ia,m+u[0].width),Math.max(0,P-u[1].width),Math.max(0,F-u[2].width)).bottomRight.subdivide(0.5);m=ja(ga,y+E,I,G).bottomLeft.subdivide(0.5);y=ja(ga+u[3].width,y+E,Math.max(0,I-u[3].width), Math.max(0,G-u[2].width)).bottomLeft.subdivide(0.5);ia=[];switch(K(a,"backgroundClip")){case "content-box":case "padding-box":S(ia,B[0],B[1],R,p,r.left+u[3].width,r.top+u[0].width);S(ia,B[1],B[2],p,n,r.left+r.width-u[1].width,r.top+u[0].width);S(ia,B[2],B[3],n,y,r.left+r.width-u[1].width,r.top+r.height-u[2].width);S(ia,B[3],B[0],y,R,r.left+u[3].width,r.top+r.height-u[2].width);break;default:S(ia,B[0],B[1],j,q,r.left,r.top),S(ia,B[1],B[2],q,h,r.left+r.width,r.top),S(ia,B[2],B[3],h,m,r.left+r.width, r.top+r.height),S(ia,B[3],B[0],m,j,r.left,r.top+r.height)}ga=[];for(I=0;4>I;I++)if(0<u[I].width){G=fa;E=da;F=O;P=ca-u[2].width;switch(I){case 0:P=u[0].width;z=W({c1:[G,E],c2:[G+F,E],c3:[G+F-u[1].width,E+P],c4:[G+u[3].width,E+P]},B[0],B[1],j,R,q,p);break;case 1:G=fa+O-u[1].width;F=u[1].width;z=W({c1:[G+F,E],c2:[G+F,E+P+u[2].width],c3:[G,E+P],c4:[G,E+u[0].width]},B[1],B[2],q,p,h,n);break;case 2:E=E+ca-u[2].width;P=u[2].width;z=W({c1:[G+F,E+P],c2:[G,E+P],c3:[G+u[3].width,E],c4:[G+F-u[2].width,E]},B[2], B[3],h,n,m,y);break;case 3:F=u[3].width,z=W({c1:[G,E+P+u[2].width],c2:[G,E],c3:[G+F,E+u[0].width],c4:[G+F,E+P]},B[3],B[0],m,y,j,R)}ga.push({args:z,color:u[I].color})}D(U,ia);U.save();U.clip();if(0<T.height&&0<T.width){g(U,r.left,r.top,r.width,r.height,v);v=K(a,"backgroundImage");z=f.Util.parseBackgroundImage(v);for(fa=z.length;fa--;)v=z[fa],v.args&&0!==v.args.length&&((j=H("url"===v.method?v.args[0]:v.value))?Z(a,T,U,j,fa):t("html2canvas: Error loading background:",v))}U.restore();ga.forEach(function(a){var b= a.args;a=a.color;"transparent"!==a&&(U.setVariable("fillStyle",a),D(U,b),U.fill())});if(!s&&(s=X(a,":before"),v=X(a,":after"),s||v))s&&(a.className+=" "+ka+"-before",a.parentNode.insertBefore(s,a),aa(s,c,!0),a.parentNode.removeChild(s),a.className=a.className.replace(ka+"-before","").trim()),v&&(a.className+=" "+ka+"-after",a.appendChild(v),aa(v,c,!0),a.removeChild(v),a.className=a.className.replace(ka+"-after","").trim());switch(a.nodeName){case "IMG":(C=H(a.getAttribute("src")))?Q(U,a,C,r,u):t("html2canvas: Error loading <img>:"+ a.getAttribute("src"));break;case "INPUT":/^(text|url|email|submit|button|reset)$/.test(a.type)&&0<(a.value||a.placeholder).length&&N(a,r,c);break;case "TEXTAREA":0<(a.value||a.placeholder||"").length&&N(a,r,c);break;case "SELECT":0<(a.options||a.placeholder||"").length&&N(a,r,c);break;case "LI":var ea,r=c.ctx;C=K(a,"listStyleType");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(C)){s=-1;v=1;z=a.parentNode.childNodes; if(a.parentNode){for(;z[++s]!==a;)1===z[s].nodeType&&v++;s=v}else s=-1;switch(C){case "decimal":ea=s;break;case "decimal-leading-zero":ea=1===s.toString().length?"0"+s.toString():s.toString();break;case "upper-roman":ea=f.Generate.ListRoman(s);break;case "lower-roman":ea=f.Generate.ListRoman(s).toLowerCase();break;case "lower-alpha":ea=f.Generate.ListAlpha(s).toLowerCase();break;case "upper-alpha":ea=f.Generate.ListAlpha(s)}ea+=". ";s=w.createElement("boundelement");s.style.display="inline";v=a.style.listStyleType; a.style.listStyleType="none";s.appendChild(w.createTextNode(ea));a.insertBefore(s,a.firstChild);C=f.Util.Bounds(s);a.removeChild(s);a.style.listStyleType=v;V(r,a,"none",K(a,"color"));"inside"===K(a,"listStylePosition")&&(r.setVariable("textAlign","left"),s=T.left,C=C.bottom,null!==ea&&0<f.Util.trimText(ea).length&&r.fillText(ea,s,C))}break;case "CANVAS":Q(U,a,a,r,u)}return c}function aa(a,b,c){"none"!==K(a,"display")&&("hidden"!==K(a,"visibility")&&!a.hasAttribute("data-html2canvas-ignore"))&&(b= I(a,b,c)||b,oa.test(a.nodeName)||f.Util.Children(a).forEach(function(d){1===d.nodeType?aa(d,b,c):3===d.nodeType&&q(a,d,b)}))}h.scroll(0,0);var R=d.elements===c?m.body:d.elements[0],w=R.ownerDocument,s=f.Util.Support(d,w),oa=RegExp("("+d.ignoreElements+")"),ba=w.body,K=f.Util.getCSS,ka="___html2canvas___pseudoelement",fa=w.createElement("style");fa.innerHTML="."+ka+'-before:before { content: "" !important; display: none !important; }.'+ka+'-after:after { content: "" !important; display: none !important; }'; ba.appendChild(fa);a=a||{};var ja,ca=4*((Math.sqrt(2)-1)/3);ja=function(a,b,c,d){var e=c*ca,f=d*ca;c=a+c;d=b+d;return{topLeft:O({x:a,y:d},{x:a,y:d-f},{x:c-e,y:b},{x:c,y:b}),topRight:O({x:a,y:b},{x:a+e,y:b},{x:c,y:d-f},{x:c,y:d}),bottomRight:O({x:c,y:b},{x:c,y:b+f},{x:a+e,y:d},{x:a,y:d}),bottomLeft:O({x:c,y:d},{x:c-e,y:d},{x:a,y:b+f},{x:a,y:b})}};var U=I(R,null);if(s.svgRendering){var P=m.documentElement,E=function(a){a=f.Util.Children(a);var b=a.length,c,d,e,g,s;for(s=0;s<b;s+=1)if(g=a[s],3===g.nodeType)F+= g.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");else if(1===g.nodeType&&!/^(script|meta|title)$/.test(g.nodeName.toLowerCase())){F+="<"+g.nodeName.toLowerCase();if(g.hasAttributes()){c=g.attributes;e=c.length;for(d=0;d<e;d+=1)F+=" "+c[d].name+'="'+c[d].value+'"'}F+=">";E(g);F+="</"+g.nodeName.toLowerCase()+">"}},C=new Image,T=b(),da=l(),F="";E(P);C.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='"+T+"' height='"+da+"'>","<foreignObject width='"+T+"' height='"+ da+"'>","<html xmlns='http://www.w3.org/1999/xhtml' style='margin:0;'>",F.replace(/\#/g,"%23"),"</html></foreignObject></svg>"].join("");C.onload=function(){U.svgRender=C}}Array.prototype.slice.call(R.children,0).forEach(function(a){aa(a,U)});U.backgroundColor=K(m.documentElement,"backgroundColor");ba.removeChild(fa);return U};f.Preload=function(a){function d(){t("html2canvas: start: images: "+q.numLoaded+" / "+q.numTotal+" (failed: "+q.numFailed+")");!q.firstRun&&q.numLoaded>=q.numTotal&&(t("Finished loading images: # "+ q.numTotal+" (failed: "+q.numFailed+")"),"function"===typeof a.complete&&a.complete(q))}function b(b,e,f){var g,l=a.proxy,n;N.href=b;b=N.href;g="html2canvas_"+O++;f.callbackname=g;l=-1<l.indexOf("?")?l+"&":l+"?";l+="url="+encodeURIComponent(b)+"&callback="+g;n=S.createElement("script");h[g]=function(a){"error:"===a.substring(0,6)?(f.succeeded=!1,q.numLoaded++,q.numFailed++,d()):(V(e,f),e.src=a);h[g]=c;try{delete h[g]}catch(b){}n.parentNode.removeChild(n);n=null;delete f.script;delete f.callbackname}; n.setAttribute("type","text/javascript");n.setAttribute("src",l);f.script=n;h.document.body.appendChild(n)}function l(a,b){var c=h.getComputedStyle(a,b),d=c.content;"url"===d.substr(0,3)&&x.loadImage(f.Util.parseBackgroundImage(d)[0].args[0]);g(c.backgroundImage,a)}function e(a){return a&&a.method&&a.args&&0<a.args.length}function g(a,b){var g;f.Util.parseBackgroundImage(a).filter(e).forEach(function(a){if("url"===a.method)x.loadImage(a.args[0]);else if(a.method.match(/\-?gradient$/)){g===c&&(g=f.Util.Bounds(b)); a=a.value;var e=f.Generate.Gradient(a,g);e!==c&&(q[a]={img:e,succeeded:!0},q.numTotal++,q.numLoaded++,d())}})}function n(a){var b=!1;try{f.Util.Children(a).forEach(function(a){n(a)})}catch(d){}try{b=a.nodeType}catch(e){b=!1,t("html2canvas: failed to access some element's nodeType - Exception: "+e.message)}if(1===b||b===c){l(a,":before");l(a,":after");try{g(f.Util.getCSS(a,"backgroundImage"),a)}catch(q){t("html2canvas: failed to get background-image - Exception: "+q.message)}g(a)}}function V(e,f){e.onload= function(){f.timer!==c&&h.clearTimeout(f.timer);q.numLoaded++;f.succeeded=!0;e.onerror=e.onload=null;d()};e.onerror=function(){if("anonymous"===e.crossOrigin&&(h.clearTimeout(f.timer),a.proxy)){var c=e.src;e=new Image;f.img=e;e.src=c;b(e.src,e,f);return}q.numLoaded++;q.numFailed++;f.succeeded=!1;e.onerror=e.onload=null;d()}}var q={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},H,x,Q,O=0;Q=a.elements[0]||m.body;var S=Q.ownerDocument,W=S.images,D=W.length,N=S.createElement("a"),z;z=(new Image).crossOrigin!== c;var X;N.href=h.location.href;H=N.protocol+N.host;x={loadImage:function(d){var e,f;d&&q[d]===c&&(e=new Image,d.match(/data:image\/.*;base64,/i)?(e.src=d.replace(/url\(['"]{0,}|['"]{0,}\)$/ig,""),f=q[d]={img:e},q.numTotal++,V(e,f)):(N.href=d,N.href=N.href,N.protocol+N.host===H||!0===a.allowTaint?(f=q[d]={img:e},q.numTotal++,V(e,f),e.src=d):z&&!a.allowTaint&&a.useCORS?(e.crossOrigin="anonymous",f=q[d]={img:e},q.numTotal++,V(e,f),e.src=d,e.customComplete=function(){if(this.img.complete)this.img.onerror(); else this.timer=h.setTimeout(this.img.customComplete,100)}.bind(f),e.customComplete()):a.proxy&&(f=q[d]={img:e},q.numTotal++,b(d,e,f))))},cleanupDOM:function(b){var e,f;if(!q.cleanupDone){b&&"string"===typeof b?t("html2canvas: Cleanup because: "+b):t("html2canvas: Cleanup after timeout: "+a.timeout+" ms.");for(f in q)if(q.hasOwnProperty(f)&&(e=q[f],"object"===typeof e&&e.callbackname&&e.succeeded===c)){h[e.callbackname]=c;try{delete h[e.callbackname]}catch(g){}e.script&&e.script.parentNode&&(e.script.setAttribute("src", "about:blank"),e.script.parentNode.removeChild(e.script));q.numLoaded++;q.numFailed++;t("html2canvas: Cleaned up failed img: '"+f+"' Steps: "+q.numLoaded+" / "+q.numTotal)}h.stop!==c?h.stop():m.execCommand!==c&&m.execCommand("Stop",!1);m.close!==c&&m.close();q.cleanupDone=!0;b&&"string"===typeof b||d()}},renderingDone:function(){X&&h.clearTimeout(X)}};0<a.timeout&&(X=h.setTimeout(x.cleanupDOM,a.timeout));t("html2canvas: Preload starts: finding background-images");q.firstRun=!0;n(Q);t("html2canvas: Preload: Finding images"); for(Q=0;Q<D;Q+=1)x.loadImage(W[Q].getAttribute("src"));q.firstRun=!1;t("html2canvas: Preload: Done.");q.numTotal===q.numLoaded&&d();return x};f.Renderer=function(a,d){var b=d.renderer;if("string"===typeof d.renderer&&f.Renderer[b]!==c)b=f.Renderer[b](d);else if("function"===typeof b)b=b(d);else throw Error("Unknown renderer");if("function"!==typeof b)throw Error("Invalid renderer defined");var l=m,e=[],g=function(a){var b=[],c=[];a.children.forEach(function(a){a.children&&0<a.children.length?(b.push(a), c.push(a.zindex)):e.push(a)});c.sort(function(a,b){return a-b});c.forEach(function(a){var c;b.some(function(b,d){c=d;return b.zindex===a});g(b.splice(c,1)[0])})};g(a.zIndex);return b(a,d,l,e,f)};f.Util.Support=function(a,d){function b(){var a=new Image,b=d.createElement("canvas"),e=b.getContext===c?!1:b.getContext("2d");if(!1===e)return!1;b.width=b.height=10;a.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'><foreignObject width='10' height='10'><div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>sup</div></foreignObject></svg>"; try{e.drawImage(a,0,0),b.toDataURL()}catch(f){return!1}t("html2canvas: Parse: SVG powered rendering available");return!0}var f,e,g=!1;d.createRange&&(f=d.createRange(),f.getBoundingClientRect&&(e=d.createElement("boundtest"),e.style.height="123px",e.style.display="block",d.body.appendChild(e),f.selectNode(e),f=f.getBoundingClientRect(),f=f.height,123===f&&(g=!0),d.body.removeChild(e)));return{rangeBounds:g,svgRendering:a.svgRendering&&b()}};h.html2canvas=function(a,c){a=a.length?a:[a];var b,d,e={logging:!1, elements:a,background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"},e=f.Util.Extend(c,e);f.logging=e.logging;e.complete=function(a){if(!("function"===typeof e.onpreloaded&&!1===e.onpreloaded(a))&&(b=f.Parse(a,e),!("function"===typeof e.onparsed&&!1===e.onparsed(b))&&(d=f.Renderer(b,e),"function"===typeof e.onrendered)))e.onrendered(d)};h.setTimeout(function(){f.Preload(e)}, 0);return{render:function(a,b){return f.Renderer(a,f.Util.Extend(b,e))},parse:function(a,b){return f.Parse(a,f.Util.Extend(b,e))},preload:function(a){return f.Preload(f.Util.Extend(a,e))},log:t}};h.html2canvas.log=t;h.html2canvas.Renderer={Canvas:c};f.Renderer.Canvas=function(a){function d(c,l){switch(l.type){case "variable":c[l.name]=l.arguments;break;case "function":if("createPattern"===l.name){if(0<l.arguments[0].width&&0<l.arguments[0].height)try{c.fillStyle=c.createPattern(l.arguments[0],"repeat")}catch(h){t("html2canvas: Renderer: Error creating pattern", h.message)}}else if("drawShape"===l.name){var n=l.arguments;c.beginPath();n.forEach(function(a){c[a.name].apply(c,a.arguments)});c.closePath()}else if("drawImage"===l.name){if(0<l.arguments[8]&&0<l.arguments[7]){if(!(n=!a.taintTest))if(n=a.taintTest)a:{if(-1===f.indexOf(l.arguments[0].src)){g.drawImage(l.arguments[0],0,0);try{g.getImageData(0,0,1,1)}catch(m){e=b.createElement("canvas");g=e.getContext("2d");n=!1;break a}f.push(l.arguments[0].src)}n=!0}n&&c.drawImage.apply(c,l.arguments)}}else c[l.name].apply(c, l.arguments)}}a=a||{};var b=m,f=[],e=m.createElement("canvas"),g=e.getContext("2d"),l=a.canvas||b.createElement("canvas");return function(a,b,e,f,g){var n=l.getContext("2d"),h,m;l.width=l.style.width=b.width||a.ctx.width;l.height=l.style.height=b.height||a.ctx.height;h=n.fillStyle;n.fillStyle=("transparent"===a.backgroundColor||"rgba(0, 0, 0, 0)"===a.backgroundColor)&&b.background!==c?b.background:a.backgroundColor;n.fillRect(0,0,l.width,l.height);n.fillStyle=h;if(b.svgRendering&&a.svgRender!==c)n.drawImage(a.svgRender, 0,0);else{h=0;for(m=f.length;h<m;h+=1)a=f.splice(0,1)[0],a.canvasPosition=a.canvasPosition||{},n.textBaseline="bottom",a.clip&&(n.save(),n.beginPath(),n.rect(a.clip.left,a.clip.top,a.clip.width,a.clip.height),n.clip()),a.ctx.storage&&a.ctx.storage.forEach(d.bind(null,n)),a.clip&&n.restore()}t("html2canvas: Renderer: Canvas renderer done - returning canvas obj");m=b.elements.length;return 1===m&&"object"===typeof b.elements[0]&&"BODY"!==b.elements[0].nodeName?(b=g.Util.Bounds(b.elements[0]),e=e.createElement("canvas"), e.width=b.width,e.height=b.height,n=e.getContext("2d"),n.drawImage(l,b.left,b.top,b.width,b.height,0,0,b.width,b.height),l=null,e):l}}})(window,document); (function(h){h.fn.html2canvas=function(m){function c(a,c){window.clearTimeout(f);f=window.setTimeout(function(){x.fadeOut(function(){x.remove();x=null})},c||2E3);x&&x.remove();x=h("<div />").html(a).css({margin:0,padding:10,background:"#000",opacity:0.7,position:"fixed",top:10,right:10,fontFamily:"Tahoma",color:"#fff",fontSize:12,borderRadius:12,width:"auto",height:"auto",textAlign:"center",textDecoration:"none",display:"none"}).appendTo(document.body).fadeIn();t.log(a)}m&&(m.profile&&window.console&& window.console.profile)&&console.profile();var t,x=null,f=!1,a=(new Date).getTime();m=m||{};m.onrendered=m.onrendered||function(d){var f=h(d);d=new Date;m&&(m.profile&&window.console&&window.console.profileEnd)&&console.profileEnd();f.css({position:"absolute",left:0,top:0}).appendTo(document.body);f.siblings().toggle();h(window).click(function(){f.toggle().siblings().toggle();c("Canvas Render "+(f.is(":visible")?"visible":"hidden"))});c("Screenshot created in "+(d.getTime()-a)+" ms<br />",4E3);try{f[0].toDataURL()}catch(n){"canvas"=== f[0].nodeName.toLowerCase()&&alert("Canvas is tainted, unable to read data")}};t=html2canvas(this,m)}})(jQuery); (function(h,m){function c(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=tinycolor(a[e]),g=0.5>f.toHsl().l?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light",g=g+(tinycolor.equals(b,a[e])?" sp-thumb-active":""),l=M?"background-color:"+f.toRgbString():"filter:"+f.toFilter();d.push('<span title="'+f.toHexString()+'" data-color="'+f.toRgbString()+'" class="'+g+'"><span class="sp-thumb-inner" style="'+l+';" /></span>')}return"<div class='sp-cf "+c+"'>"+d.join("")+"</div>"}function t(a,b){var c=a.outerWidth(), d=a.outerHeight(),e=b.outerHeight(),f=a[0].ownerDocument,g=f.documentElement,l=g.clientWidth+m(f).scrollLeft(),f=g.clientHeight+m(f).scrollTop(),g=b.offset();g.top+=e;g.left-=Math.min(g.left,g.left+c>l&&l>c?Math.abs(g.left+c-l):0);g.top-=Math.min(g.top,g.top+d>f&&f>d?Math.abs(d+e-0):0);return g}function x(){}function f(a){a.stopPropagation()}function a(a,b){var c=Array.prototype.slice,d=c.call(arguments,2);return function(){return a.apply(b,d.concat(c.call(arguments)))}}function d(a,b,c,d){function e(a){a.stopPropagation&& a.stopPropagation();a.preventDefault&&a.preventDefault();a.returnValue=!1}function f(c){if(n){if(y&&9>document.documentMode&&!c.button)return g();var d=c.originalEvent.touches,l=d?d[0].pageY:c.pageY,d=Math.max(0,Math.min((d?d[0].pageX:c.pageX)-q.left,r)),l=Math.max(0,Math.min(l-q.top,p));t&&e(c);b.apply(a,[d,l,c])}}function g(){n&&(m(l).unbind(C),m(l.body).removeClass("sp-dragging"),d.apply(a,arguments));n=!1}b=b||function(){};c=c||function(){};d=d||function(){};var l=a.ownerDocument||document,n= !1,q={},p=0,r=0,t="ontouchstart"in h,C={};C.selectstart=e;C.dragstart=e;C[t?"touchmove":"mousemove"]=f;C[t?"touchend":"mouseup"]=g;m(a).bind(t?"touchstart":"mousedown",function(b){if(!(b.which?3==b.which:2==b.button)&&!n&&!1!==c.apply(a,arguments))n=!0,p=m(a).height(),r=m(a).width(),q=m(a).offset(),m(l).bind(C),m(l.body).addClass("sp-dragging"),t||f(b),e(b)})}var l={beforeShow:x,move:x,change:x,show:x,hide:x,color:!1,flat:!1,showInput:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1, showPaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",preferredFormat:!1,className:"",showAlpha:!1,theme:"sp-light",palette:["fff","000"],selectionPalette:[]},n=[],y=!!/msie/i.exec(h.navigator.userAgent),M,b=document.createElement("div").style;b.cssText="background-color:rgba(0,0,0,.5)";M=!!~(""+b.backgroundColor).indexOf("rgba")||!!~(""+b.backgroundColor).indexOf("hsla");var ha,b="";if(y)for(var e=1;6>=e;e++)b+="<div class='sp-"+ e+"'></div>";ha=["<div class='sp-container'><div class='sp-palette-container'><div class='sp-palette sp-thumb sp-cf'></div></div><div class='sp-picker-container'><div class='sp-top sp-cf'><div class='sp-fill'></div><div class='sp-top-inner'><div class='sp-color'><div class='sp-sat'><div class='sp-val'><div class='sp-dragger'></div></div></div></div><div class='sp-hue'><div class='sp-slider'></div>",b,"</div></div><div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div></div><div class='sp-input-container sp-cf'><input class='sp-input' type='text' spellcheck='false' /></div><div class='sp-initial sp-thumb sp-cf'></div><div class='sp-button-container sp-cf'><a class='sp-cancel' href='#'></a><button class='sp-choose'></button></div></div></div>"].join(""); m.fn.spectrum=function(b,e){return"string"==typeof b?"get"==b?n[this.eq(0).data("spectrum.id")].get():"container"==b?n[m(this).data("spectrum.id")].container:this.each(function(){var a=n[m(this).data("spectrum.id")];a&&("show"==b&&a.show(),"hide"==b&&a.hide(),"toggle"==b&&a.toggle(),"reflow"==b&&a.reflow(),"set"==b&&a.set(e),"destroy"==b&&(a.destroy(),m(this).removeData("spectrum.id")))}):this.spectrum("destroy").each(function(){var e,g=function(a){N&&(la.push(tinycolor(a).toHexString()),O&&h.localStorage&& (h.localStorage[O]=la.join(",")))},w=function(){var a=[],b=la,c={},d;if(D){for(var e=0;e<ga.length;e++)for(var f=0;f<ga[e].length;f++)d=tinycolor(ga[e][f]).toHexString(),c[d]=!0;for(e=0;e<b.length;e++)d=tinycolor(b[e]).toHexString(),c.hasOwnProperty(d)||(a.push(b[e]),c[d]=!0)}return a.reverse().slice(0,v.maxSelectionSize)},q=function(){var a=C(),b=m.map(ga,function(b,d){return c(b,a,"sp-palette-row sp-palette-row-"+d)});la&&b.push(c(w(),a,"sp-palette-row sp-palette-row-selection"));La.html(b.join(""))}, p=function(){if(G){var a=qa,b=C();Ma.html(c([a,b],b,"sp-palette-row-initial"))}};e=function(){(0===V||0===Z||0===wa)&&L();J.addClass(ia)};var r=function(){J.removeClass(ia)},x=function(){var a=tinycolor(na.val());a.ok?E(a):na.addClass("sp-validation-error")},ca=function(){Y?P():U()},U=function(){if(Y)L();else if(!1!==S.beforeShow(C())){for(var a=0;a<n.length;a++)n[a]&&n[a].hide();Y=!0;m(pa).bind("click.spectrum",P);m(h).bind("resize.spectrum",W);ra.addClass("sp-active");J.show();D&&q();L();da();qa= C();p();S.show(qa)}},P=function(a){if((!a||!("click"==a.type&&2==a.button))&&Y&&!z)Y=!1,m(pa).unbind("click.spectrum",P),m(h).unbind("resize.spectrum",W),ra.removeClass("sp-active"),J.hide(),tinycolor.equals(C(),qa)||(Ta&&"cancel"!==a?A(!0):E(qa,!0)),S.hide(C())},E=function(a,b){if(!tinycolor.equals(a,C())){var c=tinycolor(a),d=c.toHsv();sa=d.h;xa=d.s;ya=d.v;ma=d.a;da();b||(za=Da||c.format)}},C=function(){return tinycolor.fromRatio({h:sa,s:xa,v:ya,a:Math.round(100*ma)/100})},T=function(){da();S.move(C())}, da=function(){na.removeClass("sp-validation-error");F();var a=tinycolor({h:sa,s:"1.0",v:"1.0"});va.css("background-color",a.toHexString());a=za;if(1>ma&&("hex"===a||"name"===a))a="rgb";var b=C(),c=b.toHexString(),d=b.toRgbString();M||1===b.alpha?Ea.css("background-color",d):(Ea.css("background-color","transparent"),Ea.css("filter",b.toFilter()));if(I){d=b.toRgb();d.a=0;var d=tinycolor(d).toRgbString(),e="linear-gradient(left, "+d+", "+c+")";y?ta.css("filter",tinycolor(d).toFilter({gradientType:1}, c)):(ta.css("background","-webkit-"+e),ta.css("background","-moz-"+e),ta.css("background","-ms-"+e),ta.css("background",e))}if(H){if(1>ma&&("hex"===a||"name"===a))a="rgb";na.val(b.toString(a))}D&&q();p()},F=function(){var a=xa*Z,b=V-ya*V,a=Math.max(-X,Math.min(Z-X,a-X)),b=Math.max(-X,Math.min(V-X,b-X));Na.css({top:b,left:a});Oa.css({left:ma*Ca-Ja/2});Pa.css({top:sa*wa-Ka})},A=function(a){var b=C();Fa&&ea.val(b.toString(za)).change();var c=!tinycolor.equals(b,qa);qa=b;g(b);a&&c&&S.change(b)},L=function(){Z= va.width();V=va.height();X=Na.height();Ga.width();wa=Ga.height();Ka=Pa.height();Ca=Qa.width();Ja=Oa.width();z||J.offset(t(J,Ha));F()},v,j=m.extend({},l,b);j.callbacks={move:a(j.move,this),change:a(j.change,this),show:a(j.show,this),hide:a(j.hide,this),beforeShow:a(j.beforeShow,this)};v=j;var z=v.flat,j=v.showPaletteOnly,D=v.showPalette||j,G=v.showInitial&&!z,H=v.showInput,I=v.showAlpha,N=v.showSelectionPalette,O=v.localStorageKey,Q=v.theme,S=v.callbacks,W,aa=L,u;W=function(){var a=this,b=arguments; u||(u=setTimeout(function(){u=null;aa.apply(a,b)},10))};var Y=!1,Z=0,V=0,X=0,wa=0,Ca=0,Ja=0,Ka=0,sa=0,xa=0,ya=0,ma=1,B=v.palette.slice(0),ga=m.isArray(B[0])?B:[B],la=v.selectionPalette.slice(0),ia="sp-dragging",pa=this.ownerDocument,B=pa.body,ea=m(this),J=m(ha,pa).addClass(Q),va=J.find(".sp-color"),Na=J.find(".sp-dragger"),Ga=J.find(".sp-hue"),Pa=J.find(".sp-slider"),ta=J.find(".sp-alpha-inner"),Qa=J.find(".sp-alpha"),Oa=J.find(".sp-alpha-handle"),na=J.find(".sp-input"),La=J.find(".sp-palette"),Ma= J.find(".sp-initial"),Ra=J.find(".sp-cancel"),Sa=J.find(".sp-choose"),Fa=ea.is("input"),Ia=Fa&&!z,ra=Ia?m("<div class='sp-replacer'><div class='sp-preview'><div class='sp-preview-inner'></div></div><div class='sp-dd'>&#9660;</div></div>").addClass(Q):m([]),Ha=Ia?ra:ea,Ea=ra.find(".sp-preview-inner"),Aa=v.color||Fa&&ea.val(),qa=!1,Da=v.preferredFormat,za=Da,Ta=!v.showButtons||v.clickoutFiresChange;Sa.text(v.chooseText);Ra.text(v.cancelText);Q=function(a){a.data&&a.data.ignore?(E(m(this).data("color")), T()):(E(m(this).data("color")),A(!0),T(),P());return!1};y&&J.find("*:not(input)").attr("unselectable","on");J.toggleClass("sp-flat",z);J.toggleClass("sp-input-disabled",!H);J.toggleClass("sp-alpha-enabled",I);J.toggleClass("sp-buttons-disabled",!v.showButtons||z);J.toggleClass("sp-palette-disabled",!D);J.toggleClass("sp-palette-only",j);J.toggleClass("sp-initial-disabled",!G);J.addClass(v.className);Ia&&ea.hide().after(ra);z?ea.after(J).hide():m(B).append(J.hide());if(O&&h.localStorage)try{la=h.localStorage[O].split(",")}catch(Ua){}Ha.bind("click.spectrum touchstart.spectrum", function(a){ca();a.stopPropagation();m(a.target).is("input")||a.preventDefault()});J.click(f);na.change(x);na.bind("paste",function(){setTimeout(x,1)});na.keydown(function(a){13==a.keyCode&&x()});Ra.bind("click.spectrum",function(a){a.stopPropagation();a.preventDefault();P("cancel")});Sa.bind("click.spectrum",function(a){a.stopPropagation();a.preventDefault();na.hasClass("sp-validation-error")||(A(!0),P())});d(Qa,function(a,b,c){ma=a/Ca;c.shiftKey&&(ma=Math.round(10*ma)/10);T()});d(Ga,function(a, b){sa=b/wa;T()},e,r);d(va,function(a,b){xa=a/Z;ya=(V-b)/V;T()},e,r);Aa?(E(Aa),da(),za=Da||tinycolor(Aa).format,g(Aa)):da();z&&U();e=y?"mousedown.spectrum":"click.spectrum touchstart.spectrum";La.delegate(".sp-thumb-el",e,Q);Ma.delegate(".sp-thumb-el::nth-child(1)",e,{ignore:!0},Q);var Ba={show:U,hide:P,toggle:ca,reflow:L,set:function(a){E(a);A()},get:C,destroy:function(){ea.show();Ha.unbind("click.spectrum touchstart.spectrum");J.remove();ra.remove();n[Ba.id]=null},container:J};Ba.id=n.push(Ba)-1; e=Ba;m(this).data("spectrum.id",e.id)})};m.fn.spectrum.load=!0;m.fn.spectrum.loadOpts={};m.fn.spectrum.draggable=d;m.fn.spectrum.defaults=l;m.fn.spectrum.processNativeColorInputs=function(){var a=m("<input type='color' value='!' />")[0];"color"===a.type&&"!"!=a.value||m("input[type=color]").spectrum({preferredFormat:"hex6"})};var g=function(a){var b,c,d,e,f;if("object"==typeof a&&a.hasOwnProperty("_tc_id"))return a;c=a;var l=0,n=0,h=0;a=1;var m=!1,p=!1;if("string"==typeof c)a:{c=c.replace(Q,"").replace(O, "").toLowerCase();var y=!1;if(v[c])c=v[c],y=!0;else if("transparent"==c){c={r:0,g:0,b:0,a:0};break a}c=(b=aa.rgb.exec(c))?{r:b[1],g:b[2],b:b[3]}:(b=aa.rgba.exec(c))?{r:b[1],g:b[2],b:b[3],a:b[4]}:(b=aa.hsl.exec(c))?{h:b[1],s:b[2],l:b[3]}:(b=aa.hsla.exec(c))?{h:b[1],s:b[2],l:b[3],a:b[4]}:(b=aa.hsv.exec(c))?{h:b[1],s:b[2],v:b[3]}:(b=aa.hex6.exec(c))?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16),format:y?"name":"hex"}:(b=aa.hex3.exec(c))?{r:parseInt(b[1]+""+b[1],16),g:parseInt(b[2]+""+ b[2],16),b:parseInt(b[3]+""+b[3],16),format:y?"name":"hex"}:!1}"object"==typeof c&&(c.hasOwnProperty("r")&&c.hasOwnProperty("g")&&c.hasOwnProperty("b")?(l=255*H(c.r,255),n=255*H(c.g,255),h=255*H(c.b,255),m=!0,p="rgb"):c.hasOwnProperty("h")&&c.hasOwnProperty("s")&&c.hasOwnProperty("v")?(p=c.h,n=c.s,h=c.v,p=6*H(p,360),n=H(n,100),h=H(h,100),l=W.floor(p),m=p-l,p=h*(1-n),b=h*(1-m*n),m=h*(1-(1-m)*n),y=l%6,l=255*[h,b,p,p,m,h][y],n=255*[m,h,h,b,p,p][y],h=255*[p,p,m,h,h,b][y],m=!0,p="hsv"):c.hasOwnProperty("h")&& (c.hasOwnProperty("s")&&c.hasOwnProperty("l"))&&(l=c.h,p=c.s,h=c.l,n=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a},l=H(l,360),p=H(p,100),h=H(h,100),0===p?p=h=b=h:(b=0.5>h?h*(1+p):h+p-h*p,m=2*h-b,p=n(m,b,l+1/3),h=n(m,b,l),b=n(m,b,l-1/3)),l=255*p,n=255*h,h=255*b,m=!0,p="hsl"),c.hasOwnProperty("a")&&(a=c.a));l=N(255,z(l,0));n=N(255,z(n,0));h=N(255,z(h,0));1>l&&(l=D(l));1>n&&(n=D(n));1>h&&(h=D(h));b=m;c=c&&c.format||p;d=l;e=n;f=h;var t=r(a);return{ok:b, format:c,_tc_id:S++,alpha:t,toHsv:function(){var a=V(d,e,f);return{h:a.h,s:a.s,v:a.v,a:t}},toHsvString:function(){var a=V(d,e,f),b=D(360*a.h),c=D(100*a.s),a=D(100*a.v);return 1==t?"hsv("+b+", "+c+"%, "+a+"%)":"hsva("+b+", "+c+"%, "+a+"%, "+t+")"},toHsl:function(){var a=G(d,e,f);return{h:a.h,s:a.s,l:a.l,a:t}},toHslString:function(){var a=G(d,e,f),b=D(360*a.h),c=D(100*a.s),a=D(100*a.l);return 1==t?"hsl("+b+", "+c+"%, "+a+"%)":"hsla("+b+", "+c+"%, "+a+"%, "+t+")"},toHex:function(){return q(d,e,f)},toHexString:function(a){return"#"+ q(d,e,f,a)},toRgb:function(){return{r:D(d),g:D(e),b:D(f),a:t}},toRgbString:function(){return 1==t?"rgb("+D(d)+", "+D(e)+", "+D(f)+")":"rgba("+D(d)+", "+D(e)+", "+D(f)+", "+t+")"},toName:function(){return I[q(d,e,f)]||!1},toFilter:function(a,b){var c=q(d,e,f,!0),l=c,n=Math.round(255*r(t)).toString(16),h=n,s=a&&a.gradientType?"GradientType = 1, ":"";b&&(h=g(b),l=h.toHex(),h=Math.round(255*r(h.alpha)).toString(16));return"progid:DXImageTransform.Microsoft.gradient("+s+"startColorstr=#"+Y(n)+c+",endColorstr=#"+ Y(h)+l+")"},toString:function(a){a=a||this.format;var b=!1;"rgb"===a&&(b=this.toRgbString());"hex"===a&&(b=this.toHexString());"hex6"===a&&(b=this.toHexString(!0));"name"===a&&(b=this.toName());"hsl"===a&&(b=this.toHslString());"hsv"===a&&(b=this.toHsvString());return b||this.toHexString(!0)}}},G=function(a,b,c){a=H(a,255);b=H(b,255);c=H(c,255);var d=z(a,b,c),e=N(a,b,c),f,g=(d+e)/2;if(d==e)f=e=0;else{var l=d-e,e=0.5<g?l/(2-d-e):l/(d+e);switch(d){case a:f=(b-c)/l+(b<c?6:0);break;case b:f=(c-a)/l+2; break;case c:f=(a-b)/l+4}f/=6}return{h:f,s:e,l:g}},V=function(a,b,c){a=H(a,255);b=H(b,255);c=H(c,255);var d=z(a,b,c),e=N(a,b,c),f,g=d-e;if(d==e)f=0;else{switch(d){case a:f=(b-c)/g+(b<c?6:0);break;case b:f=(c-a)/g+2;break;case c:f=(a-b)/g+4}f/=6}return{h:f,s:0===d?0:g/d,v:d}},q=function(a,b,c,d){a=[Y(D(a).toString(16)),Y(D(b).toString(16)),Y(D(c).toString(16))];return!d&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0): a.join("")},H=function(a,b){"string"==typeof a&&(-1!=a.indexOf(".")&&1===r(a))&&(a="100%");var c="string"===typeof a&&-1!=a.indexOf("%");a=N(b,z(0,r(a)));c&&(a*=b/100);return 1E-6>W.abs(a-b)?1:1<=a?a%b/r(b):a},Y=function(a){return 1==a.length?"0"+a:""+a},Q=/^[\s,#]+/,O=/\s+$/,S=0,W=Math,D=W.round,N=W.min,z=W.max,X=W.random,r=this.parseFloat;g.fromRatio=function(a){if("object"==typeof a)for(var b in a)1===a[b]&&(a[b]="1.0");return g(a)};g.equals=function(a,b){return!a||!b?!1:g(a).toRgbString()==g(b).toRgbString()}; g.random=function(){return g.fromRatio({r:X(),g:X(),b:X()})};g.desaturate=function(a,b){var c=g(a).toHsl();c.s-=(b||10)/100;c.s=N(1,z(0,c.s));return g(c)};g.saturate=function(a,b){var c=g(a).toHsl();c.s+=(b||10)/100;c.s=N(1,z(0,c.s));return g(c)};g.greyscale=function(a){return g.desaturate(a,100)};g.lighten=function(a,b){var c=g(a).toHsl();c.l+=(b||10)/100;c.l=N(1,z(0,c.l));return g(c)};g.darken=function(a,b){var c=g(a).toHsl();c.l-=(b||10)/100;c.l=N(1,z(0,c.l));return g(c)};g.complement=function(a){a= g(a).toHsl();a.h=(a.h+0.5)%1;return g(a)};g.triad=function(a){var b=g(a).toHsl(),c=360*b.h;return[g(a),g({h:(c+120)%360,s:b.s,l:b.l}),g({h:(c+240)%360,s:b.s,l:b.l})]};g.tetrad=function(a){var b=g(a).toHsl(),c=360*b.h;return[g(a),g({h:(c+90)%360,s:b.s,l:b.l}),g({h:(c+180)%360,s:b.s,l:b.l}),g({h:(c+270)%360,s:b.s,l:b.l})]};g.splitcomplement=function(a){var b=g(a).toHsl(),c=360*b.h;return[g(a),g({h:(c+72)%360,s:b.s,l:b.l}),g({h:(c+216)%360,s:b.s,l:b.l})]};g.analogous=function(a,b,c){b=b||6;c=c||30;var d= g(a).toHsl();c=360/c;a=[g(a)];d.h*=360;for(d.h=(d.h-(c*b>>1)+720)%360;--b;)d.h=(d.h+c)%360,a.push(g(d));return a};g.monochromatic=function(a,b){b=b||6;for(var c=g(a).toHsv(),d=c.h,e=c.s,c=c.v,f=[],l=1/b;b--;)f.push(g({h:d,s:e,v:c})),c=(c+l)%1;return f};g.readable=function(a,b){var c=g(a).toRgb(),d=g(b).toRgb();return 10404<(d.r-c.r)*(d.r-c.r)+(d.g-c.g)*(d.g-c.g)+(d.b-c.b)*(d.b-c.b)};var v=g.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc", bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000", darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c", indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f", maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee", palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347", turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},b=g,e=v,p={},Z;for(Z in e)e.hasOwnProperty(Z)&&(p[e[Z]]=Z);var I=b.hexNames=p,aa;aa={rgb:RegExp("rgb[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),rgba:RegExp("rgba[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"), hsl:RegExp("hsl[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hsla:RegExp("hsla[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hsv:RegExp("hsv[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"), hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};this.tinycolor=g;m(function(){m.fn.spectrum.load&&m.fn.spectrum.processNativeColorInputs()})})(window,jQuery); (function(h,m){var c=function(a,d){return new c.Instance(a,d||{})};c.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};c.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled;c.HAS_TOUCHEVENTS="ontouchstart"in h;c.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i;c.NO_MOUSEEVENTS=c.HAS_TOUCHEVENTS&&navigator.userAgent.match(c.MOBILE_REGEX);c.EVENT_TYPES={};c.DIRECTION_DOWN= "down";c.DIRECTION_LEFT="left";c.DIRECTION_UP="up";c.DIRECTION_RIGHT="right";c.POINTER_MOUSE="mouse";c.POINTER_TOUCH="touch";c.POINTER_PEN="pen";c.EVENT_START="start";c.EVENT_MOVE="move";c.EVENT_END="end";c.DOCUMENT=document;c.plugins={};c.READY=!1;c.Instance=function(a,d){var f=this;if(!c.READY){c.event.determineEventTypes();for(var n in c.gestures)c.gestures.hasOwnProperty(n)&&c.detection.register(c.gestures[n]);c.event.onTouch(c.DOCUMENT,c.EVENT_MOVE,c.detection.detect);c.event.onTouch(c.DOCUMENT, c.EVENT_END,c.detection.detect);c.READY=!0}this.element=a;this.enabled=!0;this.options=c.utils.extend(c.utils.extend({},c.defaults),d||{});this.options.stop_browser_behavior&&c.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior);c.event.onTouch(a,c.EVENT_START,function(a){f.enabled&&c.detection.startDetect(f,a)});return this};c.Instance.prototype={on:function(a,c){for(var f=a.split(" "),n=0;n<f.length;n++)this.element.addEventListener(f[n],c,!1);return this},off:function(a, c){for(var f=a.split(" "),n=0;n<f.length;n++)this.element.removeEventListener(f[n],c,!1);return this},trigger:function(a,d){var f=c.DOCUMENT.createEvent("Event");f.initEvent(a,!0,!0);f.gesture=d;var n=this.element;c.utils.hasParent(d.target,n)&&(n=d.target);n.dispatchEvent(f);return this},enable:function(a){this.enabled=a;return this}};var t=null,x=!1,f=!1;c.event={bindDom:function(a,c,f){c=c.split(" ");for(var n=0;n<c.length;n++)a.addEventListener(c[n],f,!1)},onTouch:function(a,d,l){var n=this;this.bindDom(a, c.EVENT_TYPES[d],function(h){var m=h.type.toLowerCase();if(!m.match(/mouse/)||!f){if(m.match(/touch/)||m.match(/pointerdown/)||m.match(/mouse/)&&1===h.which)x=!0;m.match(/touch|pointer/)&&(f=!0);var b=0;x&&(c.HAS_POINTEREVENTS&&d!=c.EVENT_END?b=c.PointerEvent.updatePointer(d,h):m.match(/touch/)?b=h.touches.length:f||(b=m.match(/up/)?0:1),0<b&&d==c.EVENT_END?d=c.EVENT_MOVE:b||(d=c.EVENT_END),!b&&null!==t?h=t:t=h,l.call(c.detection,n.collectEventData(a,d,h)),c.HAS_POINTEREVENTS&&d==c.EVENT_END&&(b= c.PointerEvent.updatePointer(d,h)));b||(t=null,f=x=!1,c.PointerEvent.reset())}})},determineEventTypes:function(){var a;a=c.HAS_POINTEREVENTS?c.PointerEvent.getEvents():c.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"];c.EVENT_TYPES[c.EVENT_START]=a[0];c.EVENT_TYPES[c.EVENT_MOVE]=a[1];c.EVENT_TYPES[c.EVENT_END]=a[2]},getTouchList:function(a){return c.HAS_POINTEREVENTS?c.PointerEvent.getTouchList():a.touches? a.touches:[{identifier:1,pageX:a.pageX,pageY:a.pageY,target:a.target}]},collectEventData:function(a,d,f){a=this.getTouchList(f,d);var h=c.POINTER_TOUCH;if(f.type.match(/mouse/)||c.PointerEvent.matchType(c.POINTER_MOUSE,f))h=c.POINTER_MOUSE;return{center:c.utils.getCenter(a),timeStamp:(new Date).getTime(),target:f.target,touches:a,eventType:d,pointerType:h,srcEvent:f,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation();this.srcEvent.preventDefault&&this.srcEvent.preventDefault()}, stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return c.detection.stopDetect()}}}};c.PointerEvent={pointers:{},getTouchList:function(){var a=this,c=[];Object.keys(a.pointers).sort().forEach(function(f){c.push(a.pointers[f])});return c},updatePointer:function(a,d){a==c.EVENT_END?this.pointers={}:(d.identifier=d.pointerId,this.pointers[d.pointerId]=d);return Object.keys(this.pointers).length},matchType:function(a,d){if(!d.pointerType)return!1;var f={};f[c.POINTER_MOUSE]= d.pointerType==d.MSPOINTER_TYPE_MOUSE||d.pointerType==c.POINTER_MOUSE;f[c.POINTER_TOUCH]=d.pointerType==d.MSPOINTER_TYPE_TOUCH||d.pointerType==c.POINTER_TOUCH;f[c.POINTER_PEN]=d.pointerType==d.MSPOINTER_TYPE_PEN||d.pointerType==c.POINTER_PEN;return f[a]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}};c.utils={extend:function(a,c,f){for(var h in c)a[h]!==m&&f||(a[h]=c[h]); return a},hasParent:function(a,c){for(;a;){if(a==c)return!0;a=a.parentNode}return!1},getCenter:function(a){for(var c=[],f=[],h=0,m=a.length;h<m;h++)c.push(a[h].pageX),f.push(a[h].pageY);return{pageX:(Math.min.apply(Math,c)+Math.max.apply(Math,c))/2,pageY:(Math.min.apply(Math,f)+Math.max.apply(Math,f))/2}},getVelocity:function(a,c,f){return{x:Math.abs(c/a)||0,y:Math.abs(f/a)||0}},getAngle:function(a,c){return 180*Math.atan2(c.pageY-a.pageY,c.pageX-a.pageX)/Math.PI},getDirection:function(a,d){var f= Math.abs(a.pageX-d.pageX),h=Math.abs(a.pageY-d.pageY);return f>=h?0<a.pageX-d.pageX?c.DIRECTION_LEFT:c.DIRECTION_RIGHT:0<a.pageY-d.pageY?c.DIRECTION_UP:c.DIRECTION_DOWN},getDistance:function(a,c){var f=c.pageX-a.pageX,h=c.pageY-a.pageY;return Math.sqrt(f*f+h*h)},getScale:function(a,c){return 2<=a.length&&2<=c.length?this.getDistance(c[0],c[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,c){return 2<=a.length&&2<=c.length?this.getAngle(c[1],c[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a== c.DIRECTION_UP||a==c.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(a,c){var f,h="webkit khtml moz ms o ".split(" ");if(c&&a.style){for(var m=0;m<h.length;m++)for(var t in c)c.hasOwnProperty(t)&&(f=t,h[m]&&(f=h[m]+f.substring(0,1).toUpperCase()+f.substring(1)),a.style[f]=c[t]);"none"==c.userSelect&&(a.onselectstart=function(){return!1})}}};c.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(a,d){this.current||(this.stopped=!1,this.current={inst:a,startEvent:c.utils.extend({}, d),lastEvent:!1,name:""},this.detect(d))},detect:function(a){if(this.current&&!this.stopped){a=this.extendEventData(a);for(var d=this.current.inst.options,f=0,h=this.gestures.length;f<h;f++){var m=this.gestures[f];if(!this.stopped&&!1!==d[m.name]&&!1===m.handler.call(m,a,this.current.inst)){this.stopDetect();break}}this.current&&(this.current.lastEvent=a);a.eventType==c.EVENT_END&&!a.touches.length-1&&this.stopDetect();return a}},stopDetect:function(){this.previous=c.utils.extend({},this.current); this.current=null;this.stopped=!0},extendEventData:function(a){var d=this.current.startEvent;if(d&&(a.touches.length!=d.touches.length||a.touches===d.touches)){d.touches=[];for(var f=0,h=a.touches.length;f<h;f++)d.touches.push(c.utils.extend({},a.touches[f]))}var f=a.timeStamp-d.timeStamp,h=a.center.pageX-d.center.pageX,m=a.center.pageY-d.center.pageY,t=c.utils.getVelocity(f,h,m);c.utils.extend(a,{deltaTime:f,deltaX:h,deltaY:m,velocityX:t.x,velocityY:t.y,distance:c.utils.getDistance(d.center,a.center), angle:c.utils.getAngle(d.center,a.center),direction:c.utils.getDirection(d.center,a.center),scale:c.utils.getScale(d.touches,a.touches),rotation:c.utils.getRotation(d.touches,a.touches),startEvent:d});return a},register:function(a){var d=a.defaults||{};d[a.name]===m&&(d[a.name]=!0);c.utils.extend(c.defaults,d,!0);a.index=a.index||1E3;this.gestures.push(a);this.gestures.sort(function(a,c){return a.index<c.index?-1:a.index>c.index?1:0});return this.gestures}};c.gestures=c.gestures||{};c.gestures.Hold= {name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(a,d){switch(a.eventType){case c.EVENT_START:clearTimeout(this.timer);c.detection.current.name=this.name;this.timer=setTimeout(function(){"hold"==c.detection.current.name&&d.trigger("hold",a)},d.options.hold_timeout);break;case c.EVENT_MOVE:a.distance>d.options.hold_threshold&&clearTimeout(this.timer);break;case c.EVENT_END:clearTimeout(this.timer)}}};c.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250, tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(a,d){if(a.eventType==c.EVENT_END){var f=c.detection.previous,h=!1;if(!(a.deltaTime>d.options.tap_max_touchtime||a.distance>d.options.tap_max_distance))if(f&&("tap"==f.name&&a.timeStamp-f.lastEvent.timeStamp<d.options.doubletap_interval&&a.distance<d.options.doubletap_distance)&&(d.trigger("doubletap",a),h=!0),!h||d.options.tap_always)c.detection.current.name="tap",d.trigger(c.detection.current.name,a)}}}; c.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_max_touches:1,swipe_velocity:0.7},handler:function(a,d){if(a.eventType==c.EVENT_END&&!(0<d.options.swipe_max_touches&&a.touches.length>d.options.swipe_max_touches)&&(a.velocityX>d.options.swipe_velocity||a.velocityY>d.options.swipe_velocity))d.trigger(this.name,a),d.trigger(this.name+a.direction,a)}};c.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1, drag_lock_min_distance:25},triggered:!1,handler:function(a,d){if(c.detection.current.name!=this.name&&this.triggered)d.trigger(this.name+"end",a),this.triggered=!1;else if(!(0<d.options.drag_max_touches&&a.touches.length>d.options.drag_max_touches))switch(a.eventType){case c.EVENT_START:this.triggered=!1;break;case c.EVENT_MOVE:if(a.distance<d.options.drag_min_distance&&c.detection.current.name!=this.name)break;c.detection.current.name=this.name;if(c.detection.current.lastEvent.drag_locked_to_axis|| d.options.drag_lock_to_axis&&d.options.drag_lock_min_distance<=a.distance)a.drag_locked_to_axis=!0;var f=c.detection.current.lastEvent.direction;a.drag_locked_to_axis&&f!==a.direction&&(a.direction=c.utils.isVertical(f)?0>a.deltaY?c.DIRECTION_UP:c.DIRECTION_DOWN:0>a.deltaX?c.DIRECTION_LEFT:c.DIRECTION_RIGHT);this.triggered||(d.trigger(this.name+"start",a),this.triggered=!0);d.trigger(this.name,a);d.trigger(this.name+a.direction,a);(d.options.drag_block_vertical&&c.utils.isVertical(a.direction)||d.options.drag_block_horizontal&& !c.utils.isVertical(a.direction))&&a.preventDefault();break;case c.EVENT_END:this.triggered&&d.trigger(this.name+"end",a),this.triggered=!1}}};c.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:0.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(a,d){if(c.detection.current.name!=this.name&&this.triggered)d.trigger(this.name+"end",a),this.triggered=!1;else if(!(2>a.touches.length))switch(d.options.transform_always_block&&a.preventDefault(), a.eventType){case c.EVENT_START:this.triggered=!1;break;case c.EVENT_MOVE:var f=Math.abs(1-a.scale),h=Math.abs(a.rotation);if(f<d.options.transform_min_scale&&h<d.options.transform_min_rotation)break;c.detection.current.name=this.name;this.triggered||(d.trigger(this.name+"start",a),this.triggered=!0);d.trigger(this.name,a);h>d.options.transform_min_rotation&&d.trigger("rotate",a);f>d.options.transform_min_scale&&(d.trigger("pinch",a),d.trigger("pinch"+(1>a.scale?"in":"out"),a));break;case c.EVENT_END:this.triggered&& d.trigger(this.name+"end",a),this.triggered=!1}}};c.gestures.Touch={name:"touch",index:-Infinity,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(a,d){d.options.prevent_mouseevents&&a.pointerType==c.POINTER_MOUSE?a.stopDetect():(d.options.prevent_default&&a.preventDefault(),a.eventType==c.EVENT_START&&d.trigger(this.name,a))}};c.gestures.Release={name:"release",index:Infinity,handler:function(a,d){a.eventType==c.EVENT_END&&d.trigger(this.name,a)}};"object"===typeof module&&"object"=== typeof module.exports?module.exports=c:(h.Hammer=c,"function"===typeof h.define&&h.define.amd&&h.define("hammer",[],function(){return c}))})(this); (function(h,m){h!==m&&(Hammer.event.bindDom=function(c,t,x){h(c).on(t,function(c){var a=c.originalEvent||c;a.pageX===m&&(a.pageX=c.pageX,a.pageY=c.pageY);a.target||(a.target=c.target);a.which===m&&(a.which=a.button);a.preventDefault||(a.preventDefault=c.preventDefault);a.stopPropagation||(a.stopPropagation=c.stopPropagation);x.call(this,a)})},Hammer.Instance.prototype.on=function(c,m){return h(this.element).on(c,m)},Hammer.Instance.prototype.off=function(c,m){return h(this.element).off(c,m)},Hammer.Instance.prototype.trigger= function(c,m){var x=h(this.element);x.has(m.target).length&&(x=h(m.target));return x.trigger({type:c,gesture:m})},h.fn.hammer=function(c){return this.each(function(){var m=h(this),x=m.data("hammer");x?x&&c&&Hammer.utils.extend(x.options,c):m.data("hammer",new Hammer(this,c||{}))})})})(window.jQuery||window.Zepto);